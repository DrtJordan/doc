<!DOCTYPE html>
<!-- saved from url=(0057)http://tech.meituan.com/intro_to_logistic_regression.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Logistic Regression 模型简介 - </title><meta name="viewport" content="initial-scale=1, width=device-width, user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><link rel="stylesheet" href="./Logistic Regression 模型简介 -_files/index.css"><script type="text/javascript" async="" src="./Logistic Regression 模型简介 -_files/ga.js.下载"></script><script type="text/javascript">(function() {
    var isIPhone = window.navigator.appVersion.match(/iphone/gi);
    var devicePixelRatio = window.devicePixelRatio;
    var dpr = 1;
    if (isIPhone) {
        if (devicePixelRatio >= 3) {
            dpr = 3;
        } else if (devicePixelRatio >= 2) {
            dpr = 2;
        }
    }
    var scale = 1/2;
    
    var metaViewport = '<meta name="viewport" content="initial-scale=' + scale + ', maximum-scale=' + scale +', minimum-scale=' + scale + ', user-scalable=no, width=device-width" />';
    //- document.write(metaViewport);
    
    var docEl = document.documentElement;
    var width = docEl.getBoundingClientRect().width;
    
    if (width / dpr > 450) width = dpr * 450;
    var rem = width / 6.4;
    //- docEl.style.fontSize = rem + 'px';
})();</script><link rel="stylesheet" href="./Logistic Regression 模型简介 -_files/font-awesome.min.css"><link rel="icon" href="http://tech.meituan.com/favicon.ico" type="image/x-icon"><meta name="description" content="


逻辑回归（Logistic Regression）是机器学习中的一种分类模型，由于算法的简单和高效，在实际中应用非常广泛。本文作为美团机器学习InAction系列中的一篇，主要关注逻辑回归算法的"><!--[if lt IE 9]><script src="/js/html5shiv.js"></script><![endif]--><script src="./Logistic Regression 模型简介 -_files/index.js.下载" type="text/javascript" charset="utf-8"></script><script src="./Logistic Regression 模型简介 -_files/wb.js.下载" type="text/javascript" charset="utf-8"></script><script charset="UTF-8" src="./Logistic Regression 模型简介 -_files/query"></script><script src="./Logistic Regression 模型简介 -_files/MathJax.js.下载" type="text/javascript" charset="utf-8"></script><script type="text/x-mathjax-config;executed=true">MathJax.Hub.Config({
  displayAlign: "left",
  displayIndent: "2em",
  messageStyle: "none"
})
</script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.0') format('woff'), url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.0') format('woff'), url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.0') format('woff'), url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.0') format('woff'), url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.0') format('woff'), url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.0') format('woff'), url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.0') format('woff'), url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.0') format('woff'), url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.0') format('woff'), url('https://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.0') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head><body class="holygrail pg-post"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div><div class="holygrail-body"><div class="nav-bar"><div class="nav-bar-inner"><a href="http://tech.meituan.com/" class="nav-bar-logo"><img src="./Logistic Regression 模型简介 -_files/logo.svg"></a><span class="nav-bar-site-title"><a href="http://tech.meituan.com/">美团点评技术团队</a></span><button class="nav-bar-btn"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button></div><div class="nav-bar-tabs"><nav><span class="nav-bar-tab"><a href="http://tech.meituan.com/">最新文章</a></span><span class="nav-bar-tab"><a href="http://tech.meituan.com/archives">文章归档</a></span><span class="nav-bar-tab"><a href="http://tech.meituan.com/about">关于我们 </a></span><span class="nav-bar-tab"><a href="http://tech.meituan.com/techsalon">技术沙龙</a></span><span class="nav-bar-tab"><a href="http://tech.meituan.com/salon/#/">技术沙龙</a></span></nav></div></div><div id="post_detail" class="content"><div class="tag_header"><span>文章详情</span><form action="http://google.com/search" method="get" target="_blank" class="search"><div class="search_box"><input type="text" name="q" class="search_input"><input type="hidden" name="q" value="site:tech.meituan.com"><input type="hidden" name="gw_rd" value="cr"><input type="submit" id="search_submit"><label for="search_submit"></label></div></form></div><article class="detail_post"><header class="article__title"><h1 class="title">Logistic Regression 模型简介</h1><p class="info"><span class="nick">FIN</span><span class="Separate"> ·</span><span class="date">2015-05-08 10:00</span></p></header><div class="article__content"><p>逻辑回归（Logistic Regression）是机器学习中的一种分类模型，由于算法的简单和高效，在实际中应用非常广泛。本文作为美团机器学习InAction系列中的一篇，主要关注逻辑回归算法的数学模型和参数求解方法，最后也会简单讨论下逻辑回归和贝叶斯分类的关系，以及在多分类问题上的推广。</p>
<h2 id="-">逻辑回归</h2>
<h3 id="-">问题</h3>
<p>实际工作中，我们可能会遇到如下问题：</p>
<ol>
<li>预测一个用户是否点击特定的商品  </li>
<li>判断用户的性别  </li>
<li>预测用户是否会购买给定的品类  </li>
<li>判断一条评论是正面的还是负面的  </li>
</ol>
<p>这些都可以看做是分类问题，更准确地，都可以看做是二分类问题。同时，这些问题本身对美团也有很重要的价值，能够帮助我们更好的了解我们的用户，服务我们的用户。要解决这些问题，通常会用到一些已有的分类算法，比如逻辑回归，或者支持向量机。它们都属于有监督的学习，因此在使用这些算法之前，必须要先收集一批标注好的数据作为训练集。有些标注可以从log中拿到（用户的点击，购买），有些可以从用户填写的信息中获得（性别），也有一些可能需要人工标注（评论情感极性）。另一方面，知道了一个用户或者一条评论的标签后，我们还需要知道用什么样的特征去描述我们的数据，对用户来说，可以从用户的浏览记录和购买记录中获取相应的统计特征，而对于评论来说，最直接的则是文本特征。这样拿到数据的特征和标签后，就得到一组训练数据：</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 17.363em; display: inline-block; margin-left: 2.016em;"><span style="display: inline-block; position: relative; width: 13.857em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.21em 1013.75em 2.705em -1000.01em); top: -2.297em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math-italic;">D</span><span class="mo" id="MathJax-Span-4" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="texatom" id="MathJax-Span-5" style="padding-left: 0.29em;"><span class="mrow" id="MathJax-Span-6"><span class="mo" id="MathJax-Span-7" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-8"><span style="display: inline-block; position: relative; width: 0.98em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.53em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-9" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.578em;"><span class="mn" id="MathJax-Span-10" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mo" id="MathJax-Span-11" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-12" style="padding-left: 0.175em;"><span style="display: inline-block; position: relative; width: 0.98em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.47em 4.429em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-13" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.578em;"><span class="mn" id="MathJax-Span-14" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mo" id="MathJax-Span-15" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-16" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-17" style="font-family: MathJax_Main; padding-left: 0.175em;">(</span><span class="msubsup" id="MathJax-Span-18"><span style="display: inline-block; position: relative; width: 0.98em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.53em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-19" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.578em;"><span class="mn" id="MathJax-Span-20" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mo" id="MathJax-Span-21" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-22" style="padding-left: 0.175em;"><span style="display: inline-block; position: relative; width: 0.98em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.47em 4.429em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-23" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.578em;"><span class="mn" id="MathJax-Span-24" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mo" id="MathJax-Span-25" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-26" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-27" style="font-family: MathJax_Main; padding-left: 0.175em;">.</span><span class="mo" id="MathJax-Span-28" style="font-family: MathJax_Main; padding-left: 0.175em;">.</span><span class="mo" id="MathJax-Span-29" style="font-family: MathJax_Main; padding-left: 0.175em;">(</span><span class="msubsup" id="MathJax-Span-30"><span style="display: inline-block; position: relative; width: 1.268em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.53em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-31" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.578em;"><span class="mi" id="MathJax-Span-32" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mo" id="MathJax-Span-33" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-34" style="padding-left: 0.175em;"><span style="display: inline-block; position: relative; width: 1.268em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.47em 4.429em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-35" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.578em;"><span class="mi" id="MathJax-Span-36" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mo" id="MathJax-Span-37" style="font-family: MathJax_Main;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.356em; border-left: 0px solid; width: 0px; height: 1.584em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>D</mi><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><msup><mi>x</mi><mn>1</mn></msup><mo>,</mo><msup><mi>y</mi><mn>1</mn></msup><mo stretchy="false">)</mo><mo>,</mo><mo stretchy="false">(</mo><msup><mi>x</mi><mn>2</mn></msup><mo>,</mo><msup><mi>y</mi><mn>2</mn></msup><mo stretchy="false">)</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo stretchy="false">(</mo><msup><mi>x</mi><mi>N</mi></msup><mo>,</mo><msup><mi>y</mi><mi>N</mi></msup><mo stretchy="false">)</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-1">D = {(x^1, y^1), (x^2, y^2) ... (x^N, y^N)}</script></p>
<p>其中 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-38" style="width: 1.095em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.325em 1000.88em 2.475em -1000.01em); top: -2.297em; left: 0em;"><span class="mrow" id="MathJax-Span-39"><span class="msubsup" id="MathJax-Span-40"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.53em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-41" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.578em;"><span class="mi" id="MathJax-Span-42" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mi>i</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-2">x^i</script> 是一个 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-43" style="width: 1.095em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.67em 1000.82em 2.475em -1000.01em); top: -2.297em; left: 0em;"><span class="mrow" id="MathJax-Span-44"><span class="mi" id="MathJax-Span-45" style="font-family: MathJax_Math-italic;">m</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.722em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-3">m</script> 维的向量，<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msubsup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msubsup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-46" style="width: 10.58em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.453em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.325em 1008.35em 2.762em -1000.01em); top: -2.297em; left: 0em;"><span class="mrow" id="MathJax-Span-47"><span class="msubsup" id="MathJax-Span-48"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.53em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-49" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.578em;"><span class="mi" id="MathJax-Span-50" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mo" id="MathJax-Span-51" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mo" id="MathJax-Span-52" style="font-family: MathJax_Main; padding-left: 0.29em;">[</span><span class="msubsup" id="MathJax-Span-53"><span style="display: inline-block; position: relative; width: 0.98em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.53em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-54" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.394em 1000.3em 4.199em -1000.01em); top: -4.366em; left: 0.578em;"><span class="mi" id="MathJax-Span-55" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.394em 1000.41em 4.199em -1000.01em); top: -3.734em; left: 0.578em;"><span class="mn" id="MathJax-Span-56" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mo" id="MathJax-Span-57" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-58" style="padding-left: 0.175em;"><span style="display: inline-block; position: relative; width: 0.98em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.53em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-59" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.394em 1000.3em 4.199em -1000.01em); top: -4.366em; left: 0.578em;"><span class="mi" id="MathJax-Span-60" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.394em 1000.41em 4.199em -1000.01em); top: -3.734em; left: 0.578em;"><span class="mn" id="MathJax-Span-61" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mo" id="MathJax-Span-62" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-63" style="font-family: MathJax_Main; padding-left: 0.175em;">.</span><span class="mo" id="MathJax-Span-64" style="font-family: MathJax_Main; padding-left: 0.175em;">.</span><span class="mo" id="MathJax-Span-65" style="font-family: MathJax_Main; padding-left: 0.175em;">.</span><span class="mo" id="MathJax-Span-66" style="font-family: MathJax_Main; padding-left: 0.175em;">,</span><span class="msubsup" id="MathJax-Span-67" style="padding-left: 0.175em;"><span style="display: inline-block; position: relative; width: 1.268em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.53em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-68" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.394em 1000.3em 4.199em -1000.01em); top: -4.366em; left: 0.578em;"><span class="mi" id="MathJax-Span-69" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.567em 1000.7em 4.199em -1000.01em); top: -3.849em; left: 0.578em;"><span class="mi" id="MathJax-Span-70" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mo" id="MathJax-Span-71" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.428em; border-left: 0px solid; width: 0px; height: 1.584em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mi>i</mi></msup><mo>=</mo><mo stretchy="false">[</mo><msubsup><mi>x</mi><mn>1</mn><mi>i</mi></msubsup><mo>,</mo><msubsup><mi>x</mi><mn>2</mn><mi>i</mi></msubsup><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msubsup><mi>x</mi><mi>m</mi><mi>i</mi></msubsup><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-4">x^i = [x_1^i, x_2^i, ... , x_m^i]</script> ，<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-72" style="width: 0.693em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.52em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.67em 1000.53em 2.705em -1000.01em); top: -2.297em; left: 0em;"><span class="mrow" id="MathJax-Span-73"><span class="mi" id="MathJax-Span-74" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.356em; border-left: 0px solid; width: 0px; height: 0.938em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-5">y</script> 在 {0, 1} 中取值。（本文用{1，0}表示正例和负例，后文沿用此定义。）</p>
<p>我们的问题可以简化为，如何找到这样一个决策函数<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-75" style="width: 5.349em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.257em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.383em 1004.15em 2.705em -1000.01em); top: -2.297em; left: 0em;"><span class="mrow" id="MathJax-Span-76"><span class="msubsup" id="MathJax-Span-77"><span style="display: inline-block; position: relative; width: 0.98em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.47em 4.429em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-78" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.578em;"><span class="mo" id="MathJax-Span-79" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mo" id="MathJax-Span-80" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mi" id="MathJax-Span-81" style="font-family: MathJax_Math-italic; padding-left: 0.29em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-82" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-83" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-84" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.356em; border-left: 0px solid; width: 0px; height: 1.369em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>y</mi><mo>∗</mo></msup><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-6">y^* = f(x)</script>，它在未知数据集上能有足够好的表现。至于如何衡量一个二分类模型的好坏，我们可以用分类错误率这样的指标：<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-85" style="width: 11.442em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.143em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.383em 1009.04em 2.992em -1000.01em); top: -2.411em; left: 0em;"><span class="mrow" id="MathJax-Span-86"><span class="mi" id="MathJax-Span-87" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-88" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-89" style="font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-90" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mfrac" id="MathJax-Span-91" style="padding-left: 0.29em;"><span style="display: inline-block; position: relative; width: 0.75em; height: 0px; margin-right: 0.118em; margin-left: 0.118em;"><span style="position: absolute; clip: rect(3.394em 1000.3em 4.199em -1000.01em); top: -4.423em; left: 50%; margin-left: -0.17em;"><span class="mn" id="MathJax-Span-92" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.394em 1000.64em 4.199em -1000.01em); top: -3.619em; left: 50%; margin-left: -0.285em;"><span class="mi" id="MathJax-Span-93" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(0.865em 1000.76em 1.268em -1000.01em); top: -1.319em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.75em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.095em;"></span></span></span></span><span class="mo" id="MathJax-Span-94" style="font-family: MathJax_Size1; vertical-align: 0em; padding-left: 0.175em;">∑</span><span class="mn" id="MathJax-Span-95" style="font-family: MathJax_Main; padding-left: 0.175em;">1</span><span class="mo" id="MathJax-Span-96" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-97"><span style="display: inline-block; position: relative; width: 0.98em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.47em 4.429em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-98" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.578em;"><span class="mo" id="MathJax-Span-99" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mo" id="MathJax-Span-100" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mi" id="MathJax-Span-101" style="font-family: MathJax_Math-italic; padding-left: 0.29em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-102" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.417em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.571em; border-left: 0px solid; width: 0px; height: 1.728em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>E</mi><mi>r</mi><mi>r</mi><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><mo>∑</mo><mn>1</mn><mo stretchy="false">[</mo><msup><mi>y</mi><mo>∗</mo></msup><mo>=</mo><mi>y</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-7">Err = \frac{1}{N} \sum 1[y^* = y]</script> 。也可以用准确率，召回率，AUC等指标来衡量。</p>
<p>值得一提的是，模型效果往往和所用特征密切相关。特征工程在任何一个实用的机器学习系统中都是必不可少的，机器学习InAction系列已有一篇文章中对此做了详细的介绍，本文不再详细展开。</p>
<h3 id="-">模型</h3>
<h4 id="sigmoid-">sigmoid 函数</h4>
<p>在介绍逻辑回归模型之前，我们先引入sigmoid函数，其数学形式是：</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-103" style="width: 8.453em; display: inline-block; margin-left: 2.016em;"><span style="display: inline-block; position: relative; width: 6.729em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(0.808em 1006.74em 3.222em -1000.01em); top: -2.297em; left: 0em;"><span class="mrow" id="MathJax-Span-104"><span class="mi" id="MathJax-Span-105" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-106" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-107" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-108" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-109" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mfrac" id="MathJax-Span-110" style="padding-left: 0.29em;"><span style="display: inline-block; position: relative; width: 3.337em; height: 0px; margin-right: 0.118em; margin-left: 0.118em;"><span style="position: absolute; clip: rect(3.165em 1000.41em 4.199em -1000.01em); top: -4.711em; left: 50%; margin-left: -0.227em;"><span class="mn" id="MathJax-Span-111" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.165em 1003.23em 4.257em -1000.01em); top: -3.331em; left: 50%; margin-left: -1.607em;"><span class="mrow" id="MathJax-Span-112"><span class="mn" id="MathJax-Span-113" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-114" style="font-family: MathJax_Main; padding-left: 0.233em;">+</span><span class="msubsup" id="MathJax-Span-115" style="padding-left: 0.233em;"><span style="display: inline-block; position: relative; width: 1.497em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.41em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-116" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.309em; left: 0.463em;"><span class="texatom" id="MathJax-Span-117"><span class="mrow" id="MathJax-Span-118"><span class="mo" id="MathJax-Span-119" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-120" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(0.865em 1003.35em 1.268em -1000.01em); top: -1.319em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.337em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.095em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.002em; border-left: 0px solid; width: 0px; height: 2.806em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mi>x</mi></mrow></msup></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-8">g(x) = \frac{1}{1 + e ^ {-x}}</script></p>
<p>对应的函数曲线如下图所示：</p>
<p><img src="./Logistic Regression 模型简介 -_files/sigmoid.png" width="300" height="300"><br><!--![Sigmoid](/img/lr_intro/sigmoid.png)--></p>
<p>从上图可以看到sigmoid函数是一个s形的曲线，它的取值在[0, 1]之间，在远离0的地方函数的值会很快接近0/1。这个性质使我们能够以概率的方式来解释（后边延伸部分会简单讨论为什么用该函数做概率建模是合理的)。</p>
<h4 id="-">决策函数</h4>
<p>一个机器学习的模型，实际上是把决策函数限定在某一组条件下，这组限定条件就决定了模型的假设空间。当然，我们还希望这组限定条件简单而合理。而逻辑回归模型所做的假设是：</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-121" style="width: 19.72em; display: inline-block; margin-left: 2.016em;"><span style="display: inline-block; position: relative; width: 15.754em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(0.808em 1015.76em 3.452em -1000.01em); top: -2.297em; left: 0em;"><span class="mrow" id="MathJax-Span-122"><span class="mi" id="MathJax-Span-123" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.118em;"></span></span><span class="mo" id="MathJax-Span-124" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-125" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-126" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mn" id="MathJax-Span-127" style="font-family: MathJax_Main; padding-left: 0.29em;">1</span><span class="texatom" id="MathJax-Span-128"><span class="mrow" id="MathJax-Span-129"><span class="mo" id="MathJax-Span-130" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-131" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-132" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-133" style="font-family: MathJax_Math-italic; padding-left: 0.175em;">θ</span><span class="mo" id="MathJax-Span-134" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-135" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mi" id="MathJax-Span-136" style="font-family: MathJax_Math-italic; padding-left: 0.29em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-137" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-138"><span style="display: inline-block; position: relative; width: 1.038em; height: 0px;"><span style="position: absolute; clip: rect(3.165em 1000.47em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-139" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.463em;"><span class="mi" id="MathJax-Span-140" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mi" id="MathJax-Span-141" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-142" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-143" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mfrac" id="MathJax-Span-144" style="padding-left: 0.29em;"><span style="display: inline-block; position: relative; width: 4.429em; height: 0px; margin-right: 0.118em; margin-left: 0.118em;"><span style="position: absolute; clip: rect(3.165em 1000.41em 4.199em -1000.01em); top: -4.711em; left: 50%; margin-left: -0.227em;"><span class="mn" id="MathJax-Span-145" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(2.935em 1004.32em 4.257em -1000.01em); top: -3.101em; left: 50%; margin-left: -2.182em;"><span class="mrow" id="MathJax-Span-146"><span class="mn" id="MathJax-Span-147" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-148" style="font-family: MathJax_Main; padding-left: 0.233em;">+</span><span class="msubsup" id="MathJax-Span-149" style="padding-left: 0.233em;"><span style="display: inline-block; position: relative; width: 2.59em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.41em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-150" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.309em; left: 0.463em;"><span class="texatom" id="MathJax-Span-151"><span class="mrow" id="MathJax-Span-152"><span class="mo" id="MathJax-Span-153" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-154"><span style="display: inline-block; position: relative; width: 0.75em; height: 0px;"><span style="position: absolute; clip: rect(3.337em 1000.36em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-155" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.309em; left: 0.348em;"><span class="mi" id="MathJax-Span-156" style="font-size: 50%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mo" id="MathJax-Span-157" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span class="mi" id="MathJax-Span-158" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(0.865em 1004.44em 1.268em -1000.01em); top: -1.319em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.429em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.095em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.29em; border-left: 0px solid; width: 0px; height: 3.093em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo stretchy="false">(</mo><mi>y</mi><mo>=</mo><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo>;</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mi>g</mi><mo stretchy="false">(</mo><msup><mi>θ</mi><mi>T</mi></msup><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><msup><mi>θ</mi><mi>T</mi></msup><mo>∗</mo><mi>x</mi></mrow></msup></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-9">P(y=1|x;\theta) = g(\theta^T x) = \frac{1}{1 + e ^ {-\theta^T * x}}</script></p>
<p>这里的 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-159" style="width: 2.302em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.842em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.383em 1001.74em 2.705em -1000.01em); top: -2.297em; left: 0em;"><span class="mrow" id="MathJax-Span-160"><span class="mi" id="MathJax-Span-161" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-162" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-163" style="font-family: MathJax_Math-italic;">h</span><span class="mo" id="MathJax-Span-164" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.356em; border-left: 0px solid; width: 0px; height: 1.369em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-10">g(h)</script> 是上边提到的 sigmoid 函数，相应的决策函数为：</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;if&lt;/mtext&gt;&lt;/mrow&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mn&gt;0.5&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-165" style="width: 14.317em; display: inline-block; margin-left: 2.016em;"><span style="display: inline-block; position: relative; width: 11.442em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.383em 1011.39em 2.705em -1000.01em); top: -2.297em; left: 0em;"><span class="mrow" id="MathJax-Span-166"><span class="msubsup" id="MathJax-Span-167"><span style="display: inline-block; position: relative; width: 0.98em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.47em 4.429em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-168" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.578em;"><span class="mo" id="MathJax-Span-169" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mo" id="MathJax-Span-170" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mn" id="MathJax-Span-171" style="font-family: MathJax_Main; padding-left: 0.29em;">1</span><span class="mo" id="MathJax-Span-172" style="font-family: MathJax_Main;">,</span><span class="mspace" id="MathJax-Span-173" style="height: 0em; vertical-align: 0em; width: 0.175em; display: inline-block; overflow: hidden;"></span><span class="texatom" id="MathJax-Span-174" style="padding-left: 0.175em;"><span class="mrow" id="MathJax-Span-175"><span class="mtext" id="MathJax-Span-176" style="font-family: MathJax_Main;">if</span></span></span><span class="mspace" id="MathJax-Span-177" style="height: 0em; vertical-align: 0em; width: 0.175em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-178" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.118em;"></span></span><span class="mo" id="MathJax-Span-179" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-180" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-181" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mn" id="MathJax-Span-182" style="font-family: MathJax_Main; padding-left: 0.29em;">1</span><span class="texatom" id="MathJax-Span-183"><span class="mrow" id="MathJax-Span-184"><span class="mo" id="MathJax-Span-185" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-186" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-187" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-188" style="font-family: MathJax_Main; padding-left: 0.29em;">&gt;</span><span class="mn" id="MathJax-Span-189" style="font-family: MathJax_Main; padding-left: 0.29em;">0.5</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.356em; border-left: 0px solid; width: 0px; height: 1.369em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>y</mi><mo>∗</mo></msup><mo>=</mo><mn>1</mn><mo>,</mo><mspace width="thinmathspace"></mspace><mrow class="MJX-TeXAtom-ORD"><mtext>if</mtext></mrow><mspace width="thinmathspace"></mspace><mi>P</mi><mo stretchy="false">(</mo><mi>y</mi><mo>=</mo><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo stretchy="false">)</mo><mo>&gt;</mo><mn>0.5</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-11">y^* = 1, \, \textrm{if} \, P(y=1|x) > 0.5</script></p>
<p>选择0.5作为阈值是一个一般的做法，实际应用时特定的情况可以选择不同阈值，如果对正例的判别准确性要求高，可以选择阈值大一些，对正例的召回要求高，则可以选择阈值小一些。</p>
<h4 id="-">参数求解</h4>
<p>模型的数学形式确定后，剩下就是如何去求解模型中的参数。统计学中常用的一种方法是最大似然估计，即找到一组参数，使得在这组参数下，我们的数据的似然度（概率）越大。在逻辑回归模型中，似然度可表示为：</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x220F;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x220F;&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-190" style="width: 32.08em; display: inline-block; margin-left: 2.016em;"><span style="display: inline-block; position: relative; width: 25.641em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(2.072em 1025.65em 3.854em -1000.01em); top: -3.216em; left: 0em;"><span class="mrow" id="MathJax-Span-191"><span class="mi" id="MathJax-Span-192" style="font-family: MathJax_Math-italic;">L</span><span class="mo" id="MathJax-Span-193" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-194" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-195" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-196" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mi" id="MathJax-Span-197" style="font-family: MathJax_Math-italic; padding-left: 0.29em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.118em;"></span></span><span class="mo" id="MathJax-Span-198" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-199" style="font-family: MathJax_Math-italic;">D</span><span class="texatom" id="MathJax-Span-200"><span class="mrow" id="MathJax-Span-201"><span class="mo" id="MathJax-Span-202" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-203" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-204" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-205" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mo" id="MathJax-Span-206" style="font-family: MathJax_Size2; vertical-align: 0em; padding-left: 0.29em;">∏</span><span class="mi" id="MathJax-Span-207" style="font-family: MathJax_Math-italic; padding-left: 0.175em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.118em;"></span></span><span class="mo" id="MathJax-Span-208" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-209" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-210"><span class="mrow" id="MathJax-Span-211"><span class="mo" id="MathJax-Span-212" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-213" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-214" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-215" style="font-family: MathJax_Math-italic; padding-left: 0.175em;">θ</span><span class="mo" id="MathJax-Span-216" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-217" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mo" id="MathJax-Span-218" style="font-family: MathJax_Size2; vertical-align: 0em; padding-left: 0.29em;">∏</span><span class="mi" id="MathJax-Span-219" style="font-family: MathJax_Math-italic; padding-left: 0.175em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-220" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-221"><span style="display: inline-block; position: relative; width: 1.038em; height: 0px;"><span style="position: absolute; clip: rect(3.165em 1000.47em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-222" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.463em;"><span class="mi" id="MathJax-Span-223" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mi" id="MathJax-Span-224" style="font-family: MathJax_Math-italic;">x</span><span class="msubsup" id="MathJax-Span-225"><span style="display: inline-block; position: relative; width: 0.808em; height: 0px;"><span style="position: absolute; clip: rect(3.107em 1000.3em 4.429em -1000.01em); top: -4.021em; left: 0em;"><span class="mo" id="MathJax-Span-226" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.405em;"><span class="mi" id="MathJax-Span-227" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mo" id="MathJax-Span-228" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-229" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-230" style="font-family: MathJax_Main; padding-left: 0.233em;">−</span><span class="mi" id="MathJax-Span-231" style="font-family: MathJax_Math-italic; padding-left: 0.233em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-232" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-233"><span style="display: inline-block; position: relative; width: 1.038em; height: 0px;"><span style="position: absolute; clip: rect(3.165em 1000.47em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-234" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.463em;"><span class="mi" id="MathJax-Span-235" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mi" id="MathJax-Span-236" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-237" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-238"><span style="display: inline-block; position: relative; width: 1.727em; height: 0px;"><span style="position: absolute; clip: rect(3.107em 1000.3em 4.429em -1000.01em); top: -4.021em; left: 0em;"><span class="mo" id="MathJax-Span-239" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.405em;"><span class="texatom" id="MathJax-Span-240"><span class="mrow" id="MathJax-Span-241"><span class="mn" id="MathJax-Span-242" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-243" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-244" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.643em; border-left: 0px solid; width: 0px; height: 1.872em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>L</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mi>P</mi><mo stretchy="false">(</mo><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mo>∏</mo><mi>P</mi><mo stretchy="false">(</mo><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo>;</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mo>∏</mo><mi>g</mi><mo stretchy="false">(</mo><msup><mi>θ</mi><mi>T</mi></msup><mi>x</mi><msup><mo stretchy="false">)</mo><mi>y</mi></msup><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>g</mi><mo stretchy="false">(</mo><msup><mi>θ</mi><mi>T</mi></msup><mi>x</mi><mo stretchy="false">)</mo><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mn>1</mn><mo>−</mo><mi>y</mi></mrow></msup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-12">L(\theta) = P(D|\theta) = \prod P(y|x;\theta) = \prod g(\theta^T x) ^ y (1-g(\theta^T x))^{1-y}</script></p>
<p>取对数可以得到对数似然度：</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-245" style="width: 25.756em; display: inline-block; margin-left: 2.016em;"><span style="display: inline-block; position: relative; width: 20.583em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(2.072em 1020.48em 3.854em -1000.01em); top: -3.216em; left: 0em;"><span class="mrow" id="MathJax-Span-246"><span class="mi" id="MathJax-Span-247" style="font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-248" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-249" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-250" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-251" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mo" id="MathJax-Span-252" style="font-family: MathJax_Size2; vertical-align: 0em; padding-left: 0.29em;">∑</span><span class="texatom" id="MathJax-Span-253" style="padding-left: 0.175em;"><span class="mrow" id="MathJax-Span-254"><span class="mi" id="MathJax-Span-255" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-256" style="font-family: MathJax_Main; padding-left: 0.175em;">log</span><span class="mo" id="MathJax-Span-257"></span><span class="texatom" id="MathJax-Span-258" style="padding-left: 0.175em;"><span class="mrow" id="MathJax-Span-259"><span class="mi" id="MathJax-Span-260" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-261" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-262"><span style="display: inline-block; position: relative; width: 1.038em; height: 0px;"><span style="position: absolute; clip: rect(3.165em 1000.47em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-263" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.463em;"><span class="mi" id="MathJax-Span-264" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mi" id="MathJax-Span-265" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-266" style="font-family: MathJax_Main;">)</span></span></span><span class="mo" id="MathJax-Span-267" style="font-family: MathJax_Main; padding-left: 0.233em;">+</span><span class="mo" id="MathJax-Span-268" style="font-family: MathJax_Main; padding-left: 0.233em;">(</span><span class="mn" id="MathJax-Span-269" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-270" style="font-family: MathJax_Main; padding-left: 0.233em;">−</span><span class="mi" id="MathJax-Span-271" style="font-family: MathJax_Math-italic; padding-left: 0.233em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-272" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-273" style="font-family: MathJax_Main; padding-left: 0.175em;">log</span><span class="mo" id="MathJax-Span-274"></span><span class="texatom" id="MathJax-Span-275" style="padding-left: 0.175em;"><span class="mrow" id="MathJax-Span-276"><span class="mo" id="MathJax-Span-277" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-278" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-279" style="font-family: MathJax_Main; padding-left: 0.233em;">−</span><span class="mi" id="MathJax-Span-280" style="font-family: MathJax_Math-italic; padding-left: 0.233em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-281" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-282"><span style="display: inline-block; position: relative; width: 1.038em; height: 0px;"><span style="position: absolute; clip: rect(3.165em 1000.47em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-283" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.463em;"><span class="mi" id="MathJax-Span-284" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mi" id="MathJax-Span-285" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-286" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-287" style="font-family: MathJax_Main;">)</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.643em; border-left: 0px solid; width: 0px; height: 1.872em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>l</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mi>log</mi><mo>⁡</mo><mrow class="MJX-TeXAtom-ORD"><mi>g</mi><mo stretchy="false">(</mo><msup><mi>θ</mi><mi>T</mi></msup><mi>x</mi><mo stretchy="false">)</mo></mrow><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>y</mi><mo stretchy="false">)</mo><mi>log</mi><mo>⁡</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>g</mi><mo stretchy="false">(</mo><msup><mi>θ</mi><mi>T</mi></msup><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-13">l(\theta) = \sum {y\log{g(\theta^T x)} + (1-y)\log{(1-g(\theta^T x))}}</script></p>
<p>另一方面，在机器学习领域，我们更经常遇到的是损失函数的概念，其衡量的是模型预测错误的程度。常用的损失函数有0-1损失，log损失，hinge损失等。其中log损失在单个数据点上的定义为<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-288" style="width: 19.49em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.581em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.383em 1015.48em 2.705em -1000.01em); top: -2.297em; left: 0em;"><span class="mrow" id="MathJax-Span-289"><span class="mo" id="MathJax-Span-290" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-291" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-292" style="font-family: MathJax_Main; padding-left: 0.175em;">log</span><span class="mo" id="MathJax-Span-293"></span><span class="texatom" id="MathJax-Span-294" style="padding-left: 0.175em;"><span class="mrow" id="MathJax-Span-295"><span class="mi" id="MathJax-Span-296" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-297" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-298" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-299"><span class="mrow" id="MathJax-Span-300"><span class="mo" id="MathJax-Span-301" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-302" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-303" style="font-family: MathJax_Main;">)</span></span></span><span class="mo" id="MathJax-Span-304" style="font-family: MathJax_Main; padding-left: 0.233em;">−</span><span class="mo" id="MathJax-Span-305" style="font-family: MathJax_Main; padding-left: 0.233em;">(</span><span class="mn" id="MathJax-Span-306" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-307" style="font-family: MathJax_Main; padding-left: 0.233em;">−</span><span class="mi" id="MathJax-Span-308" style="font-family: MathJax_Math-italic; padding-left: 0.233em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-309" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-310" style="font-family: MathJax_Main; padding-left: 0.175em;">log</span><span class="mo" id="MathJax-Span-311"></span><span class="texatom" id="MathJax-Span-312" style="padding-left: 0.175em;"><span class="mrow" id="MathJax-Span-313"><span class="mn" id="MathJax-Span-314" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-315" style="font-family: MathJax_Main; padding-left: 0.233em;">−</span><span class="mi" id="MathJax-Span-316" style="font-family: MathJax_Math-italic; padding-left: 0.233em;">p</span><span class="mo" id="MathJax-Span-317" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-318" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-319"><span class="mrow" id="MathJax-Span-320"><span class="mo" id="MathJax-Span-321" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-322" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-323" style="font-family: MathJax_Main;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.356em; border-left: 0px solid; width: 0px; height: 1.369em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>−</mo><mi>y</mi><mi>log</mi><mo>⁡</mo><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mo stretchy="false">(</mo><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo stretchy="false">)</mo></mrow><mo>−</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>y</mi><mo stretchy="false">)</mo><mi>log</mi><mo>⁡</mo><mrow class="MJX-TeXAtom-ORD"><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy="false">(</mo><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo stretchy="false">)</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-14">-y\log{p(y|x)}-(1-y)\log{1-p(y|x)}</script></p>
<p>如果取整个数据集上的平均log损失，我们可以得到</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mfrac&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-324" style="width: 8.511em; display: inline-block; margin-left: 2.016em;"><span style="display: inline-block; position: relative; width: 6.786em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(0.808em 1006.68em 3.165em -1000.01em); top: -2.297em; left: 0em;"><span class="mrow" id="MathJax-Span-325"><span class="mi" id="MathJax-Span-326" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-327" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-328" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-329" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-330" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mo" id="MathJax-Span-331" style="font-family: MathJax_Main; padding-left: 0.29em;">−</span><span class="mfrac" id="MathJax-Span-332"><span style="display: inline-block; position: relative; width: 1.038em; height: 0px; margin-right: 0.118em; margin-left: 0.118em;"><span style="position: absolute; clip: rect(3.165em 1000.41em 4.199em -1000.01em); top: -4.711em; left: 50%; margin-left: -0.227em;"><span class="mn" id="MathJax-Span-333" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.165em 1000.88em 4.199em -1000.01em); top: -3.331em; left: 50%; margin-left: -0.457em;"><span class="mi" id="MathJax-Span-334" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(0.865em 1000.99em 1.268em -1000.01em); top: -1.319em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.038em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.095em;"></span></span></span></span><span class="mi" id="MathJax-Span-335" style="font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-336" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-337" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-338" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.931em; border-left: 0px solid; width: 0px; height: 2.662em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><mi>l</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-15">J(\theta) = -\frac{1}{N} l(\theta)</script></p>
<p>即在逻辑回归模型中，我们最大化似然函数和最小化log损失函数实际上是等价的。对于该优化问题，存在多种求解方法，这里以梯度下降的为例说明。梯度下降(Gradient Descent)又叫作最速梯度下降，是一种迭代求解的方法，通过在每一步选取使目标函数变化最快的一个方向调整参数的值来逼近最优值。基本步骤如下：</p>
<ul>
<li>选择下降方向（梯度方向，<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-339" style="width: 3.47em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.737em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.403em 1002.67em 2.803em -999.997em); top: -2.33em; left: 0em;"><span class="mrow" id="MathJax-Span-340"><span class="mi" id="MathJax-Span-341" style="font-family: MathJax_Main;">∇</span><span class="texatom" id="MathJax-Span-342"><span class="mrow" id="MathJax-Span-343"><span class="mi" id="MathJax-Span-344" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.07em;"></span></span><span class="mo" id="MathJax-Span-345" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-346" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-347" style="font-family: MathJax_Main;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.337em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.413em; border-left: 0px solid; width: 0px; height: 1.421em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-16">\nabla {J(\theta)}</script>）</li>
<li>选择步长，更新参数 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-348" style="width: 12.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.737em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.27em 1009.67em 2.803em -999.997em); top: -2.33em; left: 0em;"><span class="mrow" id="MathJax-Span-349"><span class="msubsup" id="MathJax-Span-350"><span style="display: inline-block; position: relative; width: 0.803em; height: 0px;"><span style="position: absolute; clip: rect(3.07em 1000.47em 4.203em -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-351" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.33em; left: 0.47em;"><span class="mi" id="MathJax-Span-352" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-353" style="font-family: MathJax_Main; padding-left: 0.27em;">=</span><span class="msubsup" id="MathJax-Span-354" style="padding-left: 0.27em;"><span style="display: inline-block; position: relative; width: 1.67em; height: 0px;"><span style="position: absolute; clip: rect(3.07em 1000.47em 4.203em -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-355" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.33em; left: 0.47em;"><span class="texatom" id="MathJax-Span-356"><span class="mrow" id="MathJax-Span-357"><span class="mi" id="MathJax-Span-358" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-359" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-360" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-361" style="font-family: MathJax_Main; padding-left: 0.203em;">−</span><span class="msubsup" id="MathJax-Span-362" style="padding-left: 0.203em;"><span style="display: inline-block; position: relative; width: 0.937em; height: 0px;"><span style="position: absolute; clip: rect(3.337em 1000.6em 4.203em -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-363" style="font-family: MathJax_Math-italic;">α</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.33em; left: 0.67em;"><span class="mi" id="MathJax-Span-364" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mi" id="MathJax-Span-365" style="font-family: MathJax_Main;">∇</span><span class="texatom" id="MathJax-Span-366"><span class="mrow" id="MathJax-Span-367"><span class="mi" id="MathJax-Span-368" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.07em;"></span></span><span class="mo" id="MathJax-Span-369" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-370"><span style="display: inline-block; position: relative; width: 1.67em; height: 0px;"><span style="position: absolute; clip: rect(3.07em 1000.47em 4.203em -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-371" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.33em; left: 0.47em;"><span class="texatom" id="MathJax-Span-372"><span class="mrow" id="MathJax-Span-373"><span class="mi" id="MathJax-Span-374" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-375" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-376" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-377" style="font-family: MathJax_Main;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.337em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.413em; border-left: 0px solid; width: 0px; height: 1.504em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>θ</mi><mi>i</mi></msup><mo>=</mo><msup><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><msup><mi>α</mi><mi>i</mi></msup><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><mi>J</mi><mo stretchy="false">(</mo><msup><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">)</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-17">\theta^i = \theta^{i-1} - \alpha^i \nabla {J(\theta^{i-1})}</script></li>
<li>重复以上两步直到满足终止条件 </li>
</ul>
<p><img src="./Logistic Regression 模型简介 -_files/gradient_descent.png" width="300" height="300"><br><!--![gradient descent](/img/lr_intro/gradient_descent.png)--></p>
<p>其中损失函数的梯度计算方法为：</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mfrac&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/munder&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-378" style="width: 16.559em; display: inline-block; margin-left: 2.016em;"><span style="display: inline-block; position: relative; width: 13.224em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(0.75em 1013.23em 3.682em -1000.01em); top: -2.297em; left: 0em;"><span class="mrow" id="MathJax-Span-379"><span class="mfrac" id="MathJax-Span-380"><span style="display: inline-block; position: relative; width: 1.325em; height: 0px; margin-right: 0.118em; margin-left: 0.118em;"><span style="position: absolute; clip: rect(3.165em 1001.22em 4.199em -1000.01em); top: -4.711em; left: 50%; margin-left: -0.572em;"><span class="mrow" id="MathJax-Span-381"><span class="mi" id="MathJax-Span-382" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="texatom" id="MathJax-Span-383"><span class="mrow" id="MathJax-Span-384"><span class="mi" id="MathJax-Span-385" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.165em 1001.05em 4.199em -1000.01em); top: -3.331em; left: 50%; margin-left: -0.514em;"><span class="mrow" id="MathJax-Span-386"><span class="mi" id="MathJax-Span-387" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="texatom" id="MathJax-Span-388"><span class="mrow" id="MathJax-Span-389"><span class="mi" id="MathJax-Span-390" style="font-family: MathJax_Math-italic;">θ</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(0.865em 1001.34em 1.268em -1000.01em); top: -1.319em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.325em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.095em;"></span></span></span></span><span class="mo" id="MathJax-Span-391" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mo" id="MathJax-Span-392" style="font-family: MathJax_Main; padding-left: 0.29em;">−</span><span class="mfrac" id="MathJax-Span-393"><span style="display: inline-block; position: relative; width: 0.75em; height: 0px; margin-right: 0.118em; margin-left: 0.118em;"><span style="position: absolute; clip: rect(3.165em 1000.41em 4.199em -1000.01em); top: -4.711em; left: 50%; margin-left: -0.227em;"><span class="mn" id="MathJax-Span-394" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.394em 1000.59em 4.199em -1000.01em); top: -3.331em; left: 50%; margin-left: -0.285em;"><span class="mi" id="MathJax-Span-395" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(0.865em 1000.7em 1.268em -1000.01em); top: -1.319em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.75em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.095em;"></span></span></span></span><span class="munderover" id="MathJax-Span-396" style="padding-left: 0.175em;"><span style="display: inline-block; position: relative; width: 1.44em; height: 0px;"><span style="position: absolute; clip: rect(2.877em 1001.39em 4.659em -1000.01em); top: -4.021em; left: 0em;"><span class="mo" id="MathJax-Span-397" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.394em 1000.24em 4.314em -1000.01em); top: -2.929em; left: 0.578em;"><span class="mi" id="MathJax-Span-398" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mo" id="MathJax-Span-399" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-400"><span style="display: inline-block; position: relative; width: 0.808em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.47em 4.429em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-401" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -3.849em; left: 0.52em;"><span class="mi" id="MathJax-Span-402" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mo" id="MathJax-Span-403" style="font-family: MathJax_Main; padding-left: 0.233em;">−</span><span class="msubsup" id="MathJax-Span-404" style="padding-left: 0.233em;"><span style="display: inline-block; position: relative; width: 0.98em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.47em 4.429em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-405" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.509em 1000.41em 4.199em -1000.01em); top: -4.366em; left: 0.578em;"><span class="mo" id="MathJax-Span-406" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.394em 1000.3em 4.199em -1000.01em); top: -3.734em; left: 0.52em;"><span class="mi" id="MathJax-Span-407" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mo" id="MathJax-Span-408" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-409"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.53em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-410" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -3.849em; left: 0.578em;"><span class="mi" id="MathJax-Span-411" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mo" id="MathJax-Span-412" style="font-family: MathJax_Main; padding-left: 0.233em;">+</span><span class="mi" id="MathJax-Span-413" style="font-family: MathJax_Math-italic; padding-left: 0.233em;">λ</span><span class="mi" id="MathJax-Span-414" style="font-family: MathJax_Math-italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.577em; border-left: 0px solid; width: 0px; height: 3.381em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow class="MJX-TeXAtom-ORD"><mi>J</mi></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><mrow class="MJX-TeXAtom-ORD"><mi>θ</mi></mrow></mrow></mfrac><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munder><mo>∑</mo><mi>i</mi></munder><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><msubsup><mi>y</mi><mi>i</mi><mo>∗</mo></msubsup><mo stretchy="false">)</mo><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi>λ</mi><mi>θ</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-18"> \frac{\partial{J}}{\partial{\theta}} = -\frac{1}{n}\sum_i (y_i - y_i^*)x_i + \lambda \theta</script></p>
<p>沿梯度负方向选择一个较小的步长可以保证损失函数是减小的，另一方面，逻辑回归的损失函数是凸函数（加入正则项后是严格凸函数），可以保证我们找到的局部最优值同时是全局最优。此外，常用的凸优化的方法都可以用于求解该问题。例如共轭梯度下降，牛顿法，LBFGS等。</p>
<h4 id="-">分类边界</h4>
<p>知道如何求解参数后，我们来看一下模型得到的最后结果是什么样的。很容易可以从sigmoid函数看出，当<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-415" style="width: 4.314em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.452em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.268em 1003.4em 2.532em -1000.01em); top: -2.297em; left: 0em;"><span class="mrow" id="MathJax-Span-416"><span class="msubsup" id="MathJax-Span-417"><span style="display: inline-block; position: relative; width: 1.038em; height: 0px;"><span style="position: absolute; clip: rect(3.165em 1000.47em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-418" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.463em;"><span class="mi" id="MathJax-Span-419" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mi" id="MathJax-Span-420" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-421" style="font-family: MathJax_Main; padding-left: 0.29em;">&gt;</span><span class="mn" id="MathJax-Span-422" style="font-family: MathJax_Main; padding-left: 0.29em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.14em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>θ</mi><mi>T</mi></msup><mi>x</mi><mo>&gt;</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-19">\theta^T x > 0 </script> 时，<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-423" style="width: 2.992em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.36em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.44em 1002.31em 2.705em -1000.01em); top: -2.297em; left: 0em;"><span class="mrow" id="MathJax-Span-424"><span class="mi" id="MathJax-Span-425" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-426" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mn" id="MathJax-Span-427" style="font-family: MathJax_Main; padding-left: 0.29em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.356em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-20">y = 1</script>，否则 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-428" style="width: 2.992em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.36em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.44em 1002.31em 2.705em -1000.01em); top: -2.297em; left: 0em;"><span class="mrow" id="MathJax-Span-429"><span class="mi" id="MathJax-Span-430" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-431" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mn" id="MathJax-Span-432" style="font-family: MathJax_Main; padding-left: 0.29em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.356em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-21">y = 0</script>。<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-433" style="width: 4.314em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.452em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.268em 1003.4em 2.475em -1000.01em); top: -2.297em; left: 0em;"><span class="mrow" id="MathJax-Span-434"><span class="msubsup" id="MathJax-Span-435"><span style="display: inline-block; position: relative; width: 1.038em; height: 0px;"><span style="position: absolute; clip: rect(3.165em 1000.47em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-436" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.463em;"><span class="mi" id="MathJax-Span-437" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mi" id="MathJax-Span-438" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-439" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mn" id="MathJax-Span-440" style="font-family: MathJax_Main; padding-left: 0.29em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>θ</mi><mi>T</mi></msup><mi>x</mi><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-22">\theta^T x = 0 </script> 是模型隐含的分类平面（在高维空间中，我们说是超平面）。所以说逻辑回归本质上是一个线性模型，但是，这不意味着只有线性可分的数据能通过LR求解，实际上，我们可以通过特征变换的方式把低维空间转换到高维空间，而在低维空间不可分的数据，到高维空间中线性可分的几率会高一些。下面两个图的对比说明了线性分类曲线和非线性分类曲线（通过特征映射）。</p>
<p><img src="./Logistic Regression 模型简介 -_files/decision_boundary_1.png" width="200" height="200">   <img src="./Logistic Regression 模型简介 -_files/decision_boundary_2.png" width="200" height="200"><br><!--![decision boundary 1](/img/lr_intro/decision_boundary_1.png) ![decision boundary 2](/img/lr_intro/decision_boundary_2.png)--></p>
<p>左图是一个线性可分的数据集，右图在原始空间中线性不可分，但是在特征转换 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&amp;gt;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-441" style="width: 16.501em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.167em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.325em 1013.06em 2.762em -1000.01em); top: -2.297em; left: 0em;"><span class="mrow" id="MathJax-Span-442"><span class="mo" id="MathJax-Span-443" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-444"><span style="display: inline-block; position: relative; width: 0.98em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.53em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-445" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -3.849em; left: 0.578em;"><span class="mn" id="MathJax-Span-446" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mo" id="MathJax-Span-447" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-448" style="padding-left: 0.175em;"><span style="display: inline-block; position: relative; width: 0.98em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.53em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-449" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -3.849em; left: 0.578em;"><span class="mn" id="MathJax-Span-450" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mo" id="MathJax-Span-451" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-452" style="font-family: MathJax_Main; padding-left: 0.29em;">=<span style="font-family: MathJax_Main;">&gt;</span></span><span class="mo" id="MathJax-Span-453" style="font-family: MathJax_Main; padding-left: 0.29em;">[</span><span class="msubsup" id="MathJax-Span-454"><span style="display: inline-block; position: relative; width: 0.98em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.53em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-455" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -3.849em; left: 0.578em;"><span class="mn" id="MathJax-Span-456" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mo" id="MathJax-Span-457" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-458" style="padding-left: 0.175em;"><span style="display: inline-block; position: relative; width: 0.98em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.53em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-459" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -3.849em; left: 0.578em;"><span class="mn" id="MathJax-Span-460" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mo" id="MathJax-Span-461" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-462" style="padding-left: 0.175em;"><span style="display: inline-block; position: relative; width: 0.98em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.53em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-463" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.394em 1000.41em 4.199em -1000.01em); top: -4.366em; left: 0.578em;"><span class="mn" id="MathJax-Span-464" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.394em 1000.41em 4.199em -1000.01em); top: -3.734em; left: 0.578em;"><span class="mn" id="MathJax-Span-465" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mo" id="MathJax-Span-466" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-467" style="padding-left: 0.175em;"><span style="display: inline-block; position: relative; width: 0.98em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.53em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-468" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.394em 1000.41em 4.199em -1000.01em); top: -4.366em; left: 0.578em;"><span class="mn" id="MathJax-Span-469" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.394em 1000.41em 4.199em -1000.01em); top: -3.734em; left: 0.578em;"><span class="mn" id="MathJax-Span-470" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mo" id="MathJax-Span-471" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-472" style="padding-left: 0.175em;"><span style="display: inline-block; position: relative; width: 0.98em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.53em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-473" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -3.849em; left: 0.578em;"><span class="mn" id="MathJax-Span-474" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-475"><span style="display: inline-block; position: relative; width: 0.98em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.53em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-476" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -3.849em; left: 0.578em;"><span class="mn" id="MathJax-Span-477" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mo" id="MathJax-Span-478" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.428em; border-left: 0px solid; width: 0px; height: 1.584em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">]</mo><mo>=&gt;</mo><mo stretchy="false">[</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>x</mi><mn>2</mn></msub><mo>,</mo><msubsup><mi>x</mi><mn>1</mn><mn>2</mn></msubsup><mo>,</mo><msubsup><mi>x</mi><mn>2</mn><mn>2</mn></msubsup><mo>,</mo><msub><mi>x</mi><mn>1</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-23">[x_1, x_2] => [x_1, x_2, x_1^2, x_2^2, x_1x_2]</script> 后的空间是线性可分的，对应的原始空间中分类边界为一条类椭圆曲线。</p>
<h4 id="-">正则化</h4>
<p>当模型的参数过多时，很容易遇到过拟合的问题。这时就需要有一种方法来控制模型的复杂度，典型的做法在优化目标中加入正则项，通过惩罚过大的参数来防止过拟合：</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-479" style="width: 33.804em; display: inline-block; margin-left: 2.016em;"><span style="display: inline-block; position: relative; width: 27.021em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.727em 1027.03em 4.084em -1000.01em); top: -3.216em; left: 0em;"><span class="mrow" id="MathJax-Span-480"><span class="mi" id="MathJax-Span-481" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-482" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-483" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-484" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-485" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mo" id="MathJax-Span-486" style="font-family: MathJax_Main; padding-left: 0.29em;">−</span><span class="mfrac" id="MathJax-Span-487"><span style="display: inline-block; position: relative; width: 1.038em; height: 0px; margin-right: 0.118em; margin-left: 0.118em;"><span style="position: absolute; clip: rect(3.165em 1000.41em 4.199em -1000.01em); top: -4.711em; left: 50%; margin-left: -0.227em;"><span class="mn" id="MathJax-Span-488" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.165em 1000.88em 4.199em -1000.01em); top: -3.331em; left: 50%; margin-left: -0.457em;"><span class="mi" id="MathJax-Span-489" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(0.865em 1000.99em 1.268em -1000.01em); top: -1.319em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.038em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.095em;"></span></span></span></span><span class="mo" id="MathJax-Span-490" style="font-family: MathJax_Size2; vertical-align: 0em; padding-left: 0.175em;">∑</span><span class="texatom" id="MathJax-Span-491" style="padding-left: 0.175em;"><span class="mrow" id="MathJax-Span-492"><span class="mi" id="MathJax-Span-493" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-494" style="font-family: MathJax_Main; padding-left: 0.175em;">log</span><span class="mo" id="MathJax-Span-495"></span><span class="texatom" id="MathJax-Span-496" style="padding-left: 0.175em;"><span class="mrow" id="MathJax-Span-497"><span class="mi" id="MathJax-Span-498" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-499" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-500"><span style="display: inline-block; position: relative; width: 1.038em; height: 0px;"><span style="position: absolute; clip: rect(3.165em 1000.47em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-501" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.463em;"><span class="mi" id="MathJax-Span-502" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mi" id="MathJax-Span-503" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-504" style="font-family: MathJax_Main;">)</span></span></span><span class="mo" id="MathJax-Span-505" style="font-family: MathJax_Main; padding-left: 0.233em;">+</span><span class="mo" id="MathJax-Span-506" style="font-family: MathJax_Main; padding-left: 0.233em;">(</span><span class="mn" id="MathJax-Span-507" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-508" style="font-family: MathJax_Main; padding-left: 0.233em;">−</span><span class="mi" id="MathJax-Span-509" style="font-family: MathJax_Math-italic; padding-left: 0.233em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-510" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-511" style="font-family: MathJax_Main; padding-left: 0.175em;">log</span><span class="mo" id="MathJax-Span-512"></span><span class="texatom" id="MathJax-Span-513" style="padding-left: 0.175em;"><span class="mrow" id="MathJax-Span-514"><span class="mo" id="MathJax-Span-515" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-516" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-517" style="font-family: MathJax_Main; padding-left: 0.233em;">−</span><span class="mi" id="MathJax-Span-518" style="font-family: MathJax_Math-italic; padding-left: 0.233em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-519" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-520"><span style="display: inline-block; position: relative; width: 1.038em; height: 0px;"><span style="position: absolute; clip: rect(3.165em 1000.47em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-521" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.463em;"><span class="mi" id="MathJax-Span-522" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mi" id="MathJax-Span-523" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-524" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-525" style="font-family: MathJax_Main;">)</span></span></span></span></span><span class="mo" id="MathJax-Span-526" style="font-family: MathJax_Main; padding-left: 0.233em;">+</span><span class="mi" id="MathJax-Span-527" style="font-family: MathJax_Math-italic; padding-left: 0.233em;">λ</span><span class="mo" id="MathJax-Span-528" style="font-family: MathJax_Main;">∥</span><span class="mi" id="MathJax-Span-529" style="font-family: MathJax_Math-italic;">w</span><span class="msubsup" id="MathJax-Span-530"><span style="display: inline-block; position: relative; width: 0.923em; height: 0px;"><span style="position: absolute; clip: rect(3.107em 1000.36em 4.429em -1000.01em); top: -4.021em; left: 0em;"><span class="mo" id="MathJax-Span-531" style="font-family: MathJax_Main;">∥</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -3.849em; left: 0.52em;"><span class="mi" id="MathJax-Span-532" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.222em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.931em; border-left: 0px solid; width: 0px; height: 2.662em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>y</mi><mi>log</mi><mo>⁡</mo><mrow class="MJX-TeXAtom-ORD"><mi>g</mi><mo stretchy="false">(</mo><msup><mi>θ</mi><mi>T</mi></msup><mi>x</mi><mo stretchy="false">)</mo></mrow><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>y</mi><mo stretchy="false">)</mo><mi>log</mi><mo>⁡</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>g</mi><mo stretchy="false">(</mo><msup><mi>θ</mi><mi>T</mi></msup><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mrow><mo>+</mo><mi>λ</mi><mo fence="false" stretchy="false">‖</mo><mi>w</mi><msub><mo fence="false" stretchy="false">‖</mo><mi>p</mi></msub></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-24">J(\theta) = -\frac{1}{N}\sum {y\log{g(\theta^T x)} + (1-y)\log{(1-g(\theta^T x))}} + \lambda \Vert w \Vert_p</script></p>
<p>一般情况下，取<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-533" style="width: 2.992em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.36em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.44em 1002.31em 2.647em -1000.01em); top: -2.297em; left: 0em;"><span class="mrow" id="MathJax-Span-534"><span class="mi" id="MathJax-Span-535" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-536" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mn" id="MathJax-Span-537" style="font-family: MathJax_Main; padding-left: 0.29em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.284em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-25">p=1</script>或<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-538" style="width: 2.992em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.36em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.44em 1002.31em 2.647em -1000.01em); top: -2.297em; left: 0em;"><span class="mrow" id="MathJax-Span-539"><span class="mi" id="MathJax-Span-540" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-541" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mn" id="MathJax-Span-542" style="font-family: MathJax_Main; padding-left: 0.29em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.284em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo>=</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-26">p=2</script>，分别对应L1，L2正则化，两者的区别可以从下图中看出来，L1正则化（左图）倾向于使参数变为0，因此能产生稀疏解。</p>
<p><img src="./Logistic Regression 模型简介 -_files/l1_reg.png" width="200" height="200">   <img src="./Logistic Regression 模型简介 -_files/l2_reg.png" width="200" height="200"></p>
<!--![l1 reg](/img/lr_intro/l1_reg.png) ![l2 reg](/img/lr_intro/l2_reg.png)-->
<p>实际应用时，由于我们数据的维度可能非常高，L1正则化因为能产生稀疏解，使用的更为广泛一些。</p>
<h2 id="-">延伸</h2>
<h3 id="-">生成模型和判别模型</h3>
<p>逻辑回归是一种判别模型，表现为直接对条件概率P(y|x)建模，而不关心背后的数据分布P(x,y)。而高斯贝叶斯模型（Gaussian Naive Bayes）是一种生成模型，先对数据的联合分布建模，再通过贝叶斯公式来计算样本属于各个类别的后验概率，即：</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-543" style="width: 13.109em; display: inline-block; margin-left: 2.016em;"><span style="display: inline-block; position: relative; width: 10.465em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(0.635em 1010.48em 3.452em -1000.01em); top: -2.297em; left: 0em;"><span class="mrow" id="MathJax-Span-544"><span class="mi" id="MathJax-Span-545" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-546" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-547" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-548"><span class="mrow" id="MathJax-Span-549"><span class="mo" id="MathJax-Span-550" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-551" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-552" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-553" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mfrac" id="MathJax-Span-554" style="padding-left: 0.29em;"><span style="display: inline-block; position: relative; width: 6.269em; height: 0px; margin-right: 0.118em; margin-left: 0.118em;"><span style="position: absolute; clip: rect(3.107em 1004.78em 4.429em -1000.01em); top: -4.768em; left: 50%; margin-left: -2.469em;"><span class="mrow" id="MathJax-Span-555"><span class="mi" id="MathJax-Span-556" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.118em;"></span></span><span class="mo" id="MathJax-Span-557" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-558" style="font-family: MathJax_Math-italic;">x</span><span class="texatom" id="MathJax-Span-559"><span class="mrow" id="MathJax-Span-560"><span class="mo" id="MathJax-Span-561" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-562" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-563" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-564" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.118em;"></span></span><span class="mo" id="MathJax-Span-565" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-566" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-567" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.107em 1006.05em 4.429em -1000.01em); top: -3.274em; left: 50%; margin-left: -3.044em;"><span class="mrow" id="MathJax-Span-568"><span class="mo" id="MathJax-Span-569" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span class="texatom" id="MathJax-Span-570" style="padding-left: 0.175em;"><span class="mrow" id="MathJax-Span-571"><span class="mi" id="MathJax-Span-572" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.118em;"></span></span><span class="mo" id="MathJax-Span-573" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-574" style="font-family: MathJax_Math-italic;">x</span><span class="texatom" id="MathJax-Span-575"><span class="mrow" id="MathJax-Span-576"><span class="mo" id="MathJax-Span-577" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-578" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-579" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-580" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.118em;"></span></span><span class="mo" id="MathJax-Span-581" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-582" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-583" style="font-family: MathJax_Main;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(0.865em 1006.28em 1.268em -1000.01em); top: -1.319em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 6.269em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.095em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.29em; border-left: 0px solid; width: 0px; height: 3.237em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>p</mi><mo stretchy="false">(</mo><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>y</mi><mo stretchy="false">)</mo><mi>P</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mrow><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>y</mi><mo stretchy="false">)</mo><mi>P</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-27">p(y|x) = \frac{P(x|y)P(y)}{\sum{P(x|y)P(y)}}</script></p>
<p>通常假设P(x|y)是高斯分布，P(y)是多项式分布，相应的参数都可以通过最大似然估计得到。如果我们考虑二分类问题，通过简单的变化可以得到：</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-584" style="width: 45.129em; display: inline-block; margin-left: 2.016em;"><span style="display: inline-block; position: relative; width: 36.103em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(0.578em 1036.11em 3.624em -1000.01em); top: -2.297em; left: 0em;"><span class="mrow" id="MathJax-Span-585"><span class="mi" id="MathJax-Span-586" style="font-family: MathJax_Main;">log</span><span class="mo" id="MathJax-Span-587"></span><span class="mfrac" id="MathJax-Span-588" style="padding-left: 0.175em;"><span style="display: inline-block; position: relative; width: 4.832em; height: 0px; margin-right: 0.118em; margin-left: 0.118em;"><span style="position: absolute; clip: rect(3.107em 1004.67em 4.429em -1000.01em); top: -4.768em; left: 50%; margin-left: -2.354em;"><span class="mrow" id="MathJax-Span-589"><span class="mi" id="MathJax-Span-590" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.118em;"></span></span><span class="mo" id="MathJax-Span-591" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-592" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-593" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mn" id="MathJax-Span-594" style="font-family: MathJax_Main; padding-left: 0.29em;">1</span><span class="texatom" id="MathJax-Span-595"><span class="mrow" id="MathJax-Span-596"><span class="mo" id="MathJax-Span-597" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-598" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-599" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.107em 1004.67em 4.429em -1000.01em); top: -3.274em; left: 50%; margin-left: -2.354em;"><span class="mrow" id="MathJax-Span-600"><span class="mi" id="MathJax-Span-601" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.118em;"></span></span><span class="mo" id="MathJax-Span-602" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-603" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-604" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mn" id="MathJax-Span-605" style="font-family: MathJax_Main; padding-left: 0.29em;">0</span><span class="texatom" id="MathJax-Span-606"><span class="mrow" id="MathJax-Span-607"><span class="mo" id="MathJax-Span-608" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-609" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-610" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(0.865em 1004.84em 1.268em -1000.01em); top: -1.319em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.832em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.095em;"></span></span></span></span><span class="mo" id="MathJax-Span-611" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mi" id="MathJax-Span-612" style="font-family: MathJax_Main; padding-left: 0.29em;">log</span><span class="mo" id="MathJax-Span-613"></span><span class="mfrac" id="MathJax-Span-614" style="padding-left: 0.175em;"><span style="display: inline-block; position: relative; width: 4.832em; height: 0px; margin-right: 0.118em; margin-left: 0.118em;"><span style="position: absolute; clip: rect(3.107em 1004.67em 4.429em -1000.01em); top: -4.768em; left: 50%; margin-left: -2.354em;"><span class="mrow" id="MathJax-Span-615"><span class="mi" id="MathJax-Span-616" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.118em;"></span></span><span class="mo" id="MathJax-Span-617" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-618" style="font-family: MathJax_Math-italic;">x</span><span class="texatom" id="MathJax-Span-619"><span class="mrow" id="MathJax-Span-620"><span class="mo" id="MathJax-Span-621" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-622" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-623" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mn" id="MathJax-Span-624" style="font-family: MathJax_Main; padding-left: 0.29em;">1</span><span class="mo" id="MathJax-Span-625" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.107em 1004.67em 4.429em -1000.01em); top: -3.274em; left: 50%; margin-left: -2.354em;"><span class="mrow" id="MathJax-Span-626"><span class="mi" id="MathJax-Span-627" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.118em;"></span></span><span class="mo" id="MathJax-Span-628" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-629" style="font-family: MathJax_Math-italic;">x</span><span class="texatom" id="MathJax-Span-630"><span class="mrow" id="MathJax-Span-631"><span class="mo" id="MathJax-Span-632" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-633" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-634" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mn" id="MathJax-Span-635" style="font-family: MathJax_Main; padding-left: 0.29em;">0</span><span class="mo" id="MathJax-Span-636" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(0.865em 1004.84em 1.268em -1000.01em); top: -1.319em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.832em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.095em;"></span></span></span></span><span class="mo" id="MathJax-Span-637" style="font-family: MathJax_Main; padding-left: 0.233em;">+</span><span class="mi" id="MathJax-Span-638" style="font-family: MathJax_Main; padding-left: 0.233em;">log</span><span class="mo" id="MathJax-Span-639"></span><span class="mfrac" id="MathJax-Span-640" style="padding-left: 0.175em;"><span style="display: inline-block; position: relative; width: 4.027em; height: 0px; margin-right: 0.118em; margin-left: 0.118em;"><span style="position: absolute; clip: rect(3.107em 1003.81em 4.429em -1000.01em); top: -4.768em; left: 50%; margin-left: -1.952em;"><span class="mrow" id="MathJax-Span-641"><span class="mi" id="MathJax-Span-642" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.118em;"></span></span><span class="mo" id="MathJax-Span-643" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-644" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-645" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mn" id="MathJax-Span-646" style="font-family: MathJax_Main; padding-left: 0.29em;">1</span><span class="mo" id="MathJax-Span-647" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.107em 1003.81em 4.429em -1000.01em); top: -3.274em; left: 50%; margin-left: -1.952em;"><span class="mrow" id="MathJax-Span-648"><span class="mi" id="MathJax-Span-649" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.118em;"></span></span><span class="mo" id="MathJax-Span-650" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-651" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-652" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mn" id="MathJax-Span-653" style="font-family: MathJax_Main; padding-left: 0.29em;">0</span><span class="mo" id="MathJax-Span-654" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(0.865em 1003.98em 1.268em -1000.01em); top: -1.319em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.027em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.095em;"></span></span></span></span><span class="mtext" id="MathJax-Span-655" style="font-family: MathJax_Main;">&nbsp;</span><span class="mo" id="MathJax-Span-656" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mo" id="MathJax-Span-657" style="font-family: MathJax_Main; padding-left: 0.29em;">−</span><span class="mfrac" id="MathJax-Span-658"><span style="display: inline-block; position: relative; width: 4.199em; height: 0px; margin-right: 0.118em; margin-left: 0.118em;"><span style="position: absolute; clip: rect(2.992em 1004.04em 4.429em -1000.01em); top: -4.768em; left: 50%; margin-left: -2.009em;"><span class="mrow" id="MathJax-Span-659"><span class="mo" id="MathJax-Span-660" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-661" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-662" style="font-family: MathJax_Main; padding-left: 0.233em;">−</span><span class="msubsup" id="MathJax-Span-663" style="padding-left: 0.233em;"><span style="display: inline-block; position: relative; width: 1.038em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.59em 4.429em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-664" style="font-family: MathJax_Math-italic;">μ</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -3.849em; left: 0.578em;"><span class="mn" id="MathJax-Span-665" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-666"><span style="display: inline-block; position: relative; width: 0.808em; height: 0px;"><span style="position: absolute; clip: rect(3.107em 1000.3em 4.429em -1000.01em); top: -4.021em; left: 0em;"><span class="mo" id="MathJax-Span-667" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.405em;"><span class="mn" id="MathJax-Span-668" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.05em 1001.57em 4.487em -1000.01em); top: -3.216em; left: 50%; margin-left: -0.744em;"><span class="mrow" id="MathJax-Span-669"><span class="mn" id="MathJax-Span-670" style="font-family: MathJax_Main;">2</span><span class="msubsup" id="MathJax-Span-671"><span style="display: inline-block; position: relative; width: 1.038em; height: 0px;"><span style="position: absolute; clip: rect(3.452em 1000.59em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-672" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.394em 1000.41em 4.199em -1000.01em); top: -4.366em; left: 0.635em;"><span class="mn" id="MathJax-Span-673" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.394em 1000.41em 4.199em -1000.01em); top: -3.734em; left: 0.578em;"><span class="mn" id="MathJax-Span-674" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(0.865em 1004.15em 1.268em -1000.01em); top: -1.319em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.199em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.095em;"></span></span></span></span><span class="mo" id="MathJax-Span-675" style="font-family: MathJax_Main; padding-left: 0.233em;">+</span><span class="mfrac" id="MathJax-Span-676" style="padding-left: 0.233em;"><span style="display: inline-block; position: relative; width: 4.199em; height: 0px; margin-right: 0.118em; margin-left: 0.118em;"><span style="position: absolute; clip: rect(2.992em 1004.04em 4.429em -1000.01em); top: -4.768em; left: 50%; margin-left: -2.009em;"><span class="mrow" id="MathJax-Span-677"><span class="mo" id="MathJax-Span-678" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-679" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-680" style="font-family: MathJax_Main; padding-left: 0.233em;">−</span><span class="msubsup" id="MathJax-Span-681" style="padding-left: 0.233em;"><span style="display: inline-block; position: relative; width: 1.038em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.59em 4.429em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-682" style="font-family: MathJax_Math-italic;">μ</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -3.849em; left: 0.578em;"><span class="mn" id="MathJax-Span-683" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-684"><span style="display: inline-block; position: relative; width: 0.808em; height: 0px;"><span style="position: absolute; clip: rect(3.107em 1000.3em 4.429em -1000.01em); top: -4.021em; left: 0em;"><span class="mo" id="MathJax-Span-685" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.405em;"><span class="mn" id="MathJax-Span-686" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.05em 1001.57em 4.544em -1000.01em); top: -3.216em; left: 50%; margin-left: -0.744em;"><span class="mrow" id="MathJax-Span-687"><span class="mn" id="MathJax-Span-688" style="font-family: MathJax_Main;">2</span><span class="msubsup" id="MathJax-Span-689"><span style="display: inline-block; position: relative; width: 1.038em; height: 0px;"><span style="position: absolute; clip: rect(3.452em 1000.59em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-690" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.394em 1000.41em 4.199em -1000.01em); top: -4.366em; left: 0.635em;"><span class="mn" id="MathJax-Span-691" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.394em 1000.41em 4.199em -1000.01em); top: -3.734em; left: 0.578em;"><span class="mn" id="MathJax-Span-692" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(0.865em 1004.15em 1.268em -1000.01em); top: -1.319em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.199em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.095em;"></span></span></span></span><span class="mtext" id="MathJax-Span-693" style="font-family: MathJax_Main;">&nbsp;</span><span class="mo" id="MathJax-Span-694" style="font-family: MathJax_Main; padding-left: 0.233em;">+</span><span class="msubsup" id="MathJax-Span-695" style="padding-left: 0.233em;"><span style="display: inline-block; position: relative; width: 0.923em; height: 0px;"><span style="position: absolute; clip: rect(3.165em 1000.47em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-696" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -3.849em; left: 0.463em;"><span class="mn" id="MathJax-Span-697" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.505em; border-left: 0px solid; width: 0px; height: 3.525em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>log</mi><mo>⁡</mo><mfrac><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>y</mi><mo>=</mo><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>y</mi><mo>=</mo><mn>0</mn><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac><mo>=</mo><mi>log</mi><mo>⁡</mo><mfrac><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>y</mi><mo>=</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mfrac><mo>+</mo><mi>log</mi><mo>⁡</mo><mfrac><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>y</mi><mo>=</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>y</mi><mo>=</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mfrac><mtext>&nbsp;</mtext><mo>=</mo><mo>−</mo><mfrac><mrow><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><msub><mi>μ</mi><mn>1</mn></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><mrow><mn>2</mn><msubsup><mi>σ</mi><mn>1</mn><mn>2</mn></msubsup></mrow></mfrac><mo>+</mo><mfrac><mrow><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><msub><mi>μ</mi><mn>0</mn></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><mrow><mn>2</mn><msubsup><mi>σ</mi><mn>0</mn><mn>2</mn></msubsup></mrow></mfrac><mtext>&nbsp;</mtext><mo>+</mo><msub><mi>θ</mi><mn>0</mn></msub></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-28"> \log\frac{P(y=1|x)}{P(y=0|x)} = \log\frac{P(x|y=1)}{P(x|y=0)} + \log\frac{P(y=1)}{P(y=0)}  \ = -\frac{(x-\mu_1)^2}{2\sigma_1^2} + \frac{(x-\mu_0)^2}{2\sigma_0^2}\ + \theta_0 </script></p>
<p>如果 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-698" style="width: 4.199em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.337em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.727em 1003.35em 2.647em -1000.01em); top: -2.297em; left: 0em;"><span class="mrow" id="MathJax-Span-699"><span class="msubsup" id="MathJax-Span-700"><span style="display: inline-block; position: relative; width: 0.98em; height: 0px;"><span style="position: absolute; clip: rect(3.452em 1000.59em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-701" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -3.849em; left: 0.578em;"><span class="mn" id="MathJax-Span-702" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mo" id="MathJax-Span-703" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="msubsup" id="MathJax-Span-704" style="padding-left: 0.29em;"><span style="display: inline-block; position: relative; width: 0.98em; height: 0px;"><span style="position: absolute; clip: rect(3.452em 1000.59em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-705" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -3.849em; left: 0.578em;"><span class="mn" id="MathJax-Span-706" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.284em; border-left: 0px solid; width: 0px; height: 0.866em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>σ</mi><mn>1</mn></msub><mo>=</mo><msub><mi>σ</mi><mn>0</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-29"> \sigma_1 = \sigma_0 </script>，二次项会抵消，我们得到一个简单的线性关系：</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-707" style="width: 11.787em; display: inline-block; margin-left: 2.016em;"><span style="display: inline-block; position: relative; width: 9.43em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(0.635em 1009.38em 3.452em -1000.01em); top: -2.297em; left: 0em;"><span class="mrow" id="MathJax-Span-708"><span class="mi" id="MathJax-Span-709" style="font-family: MathJax_Main;">log</span><span class="mo" id="MathJax-Span-710"></span><span class="mfrac" id="MathJax-Span-711" style="padding-left: 0.175em;"><span style="display: inline-block; position: relative; width: 4.832em; height: 0px; margin-right: 0.118em; margin-left: 0.118em;"><span style="position: absolute; clip: rect(3.107em 1004.67em 4.429em -1000.01em); top: -4.768em; left: 50%; margin-left: -2.354em;"><span class="mrow" id="MathJax-Span-712"><span class="mi" id="MathJax-Span-713" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.118em;"></span></span><span class="mo" id="MathJax-Span-714" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-715" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-716" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mn" id="MathJax-Span-717" style="font-family: MathJax_Main; padding-left: 0.29em;">1</span><span class="texatom" id="MathJax-Span-718"><span class="mrow" id="MathJax-Span-719"><span class="mo" id="MathJax-Span-720" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-721" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-722" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.107em 1004.67em 4.429em -1000.01em); top: -3.274em; left: 50%; margin-left: -2.354em;"><span class="mrow" id="MathJax-Span-723"><span class="mi" id="MathJax-Span-724" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.118em;"></span></span><span class="mo" id="MathJax-Span-725" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-726" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-727" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mn" id="MathJax-Span-728" style="font-family: MathJax_Main; padding-left: 0.29em;">0</span><span class="texatom" id="MathJax-Span-729"><span class="mrow" id="MathJax-Span-730"><span class="mo" id="MathJax-Span-731" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-732" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-733" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(0.865em 1004.84em 1.268em -1000.01em); top: -1.319em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.832em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.095em;"></span></span></span></span><span class="mo" id="MathJax-Span-734" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="msubsup" id="MathJax-Span-735" style="padding-left: 0.29em;"><span style="display: inline-block; position: relative; width: 1.038em; height: 0px;"><span style="position: absolute; clip: rect(3.165em 1000.47em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-736" style="font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.463em;"><span class="mi" id="MathJax-Span-737" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mi" id="MathJax-Span-738" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.29em; border-left: 0px solid; width: 0px; height: 3.237em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>log</mi><mo>⁡</mo><mfrac><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>y</mi><mo>=</mo><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>y</mi><mo>=</mo><mn>0</mn><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac><mo>=</mo><msup><mi>θ</mi><mi>T</mi></msup><mi>x</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-30">\log\frac{P(y=1|x)}{P(y=0|x)} = \theta^T x</script></p>
<p>由上式进一步可以得到：</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-739" style="width: 19.433em; display: inline-block; margin-left: 2.016em;"><span style="display: inline-block; position: relative; width: 15.524em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(0.463em 1015.53em 3.452em -1000.01em); top: -2.297em; left: 0em;"><span class="mrow" id="MathJax-Span-740"><span class="mi" id="MathJax-Span-741" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.118em;"></span></span><span class="mo" id="MathJax-Span-742" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-743" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-744" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mn" id="MathJax-Span-745" style="font-family: MathJax_Main; padding-left: 0.29em;">1</span><span class="texatom" id="MathJax-Span-746"><span class="mrow" id="MathJax-Span-747"><span class="mo" id="MathJax-Span-748" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-749" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-750" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-751" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mfrac" id="MathJax-Span-752" style="padding-left: 0.29em;"><span style="display: inline-block; position: relative; width: 3.567em; height: 0px; margin-right: 0.118em; margin-left: 0.118em;"><span style="position: absolute; clip: rect(2.82em 1001.68em 4.199em -1000.01em); top: -4.711em; left: 50%; margin-left: -0.859em;"><span class="msubsup" id="MathJax-Span-753"><span style="display: inline-block; position: relative; width: 1.67em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.41em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-754" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.463em;"><span class="texatom" id="MathJax-Span-755"><span class="mrow" id="MathJax-Span-756"><span class="msubsup" id="MathJax-Span-757"><span style="display: inline-block; position: relative; width: 0.75em; height: 0px;"><span style="position: absolute; clip: rect(3.337em 1000.36em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-758" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.309em; left: 0.348em;"><span class="mi" id="MathJax-Span-759" style="font-size: 50%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mi" id="MathJax-Span-760" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(2.935em 1003.4em 4.257em -1000.01em); top: -3.101em; left: 50%; margin-left: -1.722em;"><span class="mrow" id="MathJax-Span-761"><span class="mn" id="MathJax-Span-762" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-763" style="font-family: MathJax_Main; padding-left: 0.233em;">+</span><span class="msubsup" id="MathJax-Span-764" style="padding-left: 0.233em;"><span style="display: inline-block; position: relative; width: 1.67em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.41em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-765" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.309em; left: 0.463em;"><span class="texatom" id="MathJax-Span-766"><span class="mrow" id="MathJax-Span-767"><span class="msubsup" id="MathJax-Span-768"><span style="display: inline-block; position: relative; width: 0.75em; height: 0px;"><span style="position: absolute; clip: rect(3.337em 1000.36em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-769" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.309em; left: 0.348em;"><span class="mi" id="MathJax-Span-770" style="font-size: 50%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mi" id="MathJax-Span-771" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(0.865em 1003.58em 1.268em -1000.01em); top: -1.319em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.567em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.095em;"></span></span></span></span><span class="mo" id="MathJax-Span-772" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mfrac" id="MathJax-Span-773" style="padding-left: 0.29em;"><span style="display: inline-block; position: relative; width: 4.084em; height: 0px; margin-right: 0.118em; margin-left: 0.118em;"><span style="position: absolute; clip: rect(3.165em 1000.41em 4.199em -1000.01em); top: -4.711em; left: 50%; margin-left: -0.227em;"><span class="mn" id="MathJax-Span-774" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(2.935em 1003.98em 4.257em -1000.01em); top: -3.101em; left: 50%; margin-left: -2.009em;"><span class="mrow" id="MathJax-Span-775"><span class="mn" id="MathJax-Span-776" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-777" style="font-family: MathJax_Main; padding-left: 0.233em;">+</span><span class="msubsup" id="MathJax-Span-778" style="padding-left: 0.233em;"><span style="display: inline-block; position: relative; width: 2.245em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.41em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-779" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.309em; left: 0.463em;"><span class="texatom" id="MathJax-Span-780"><span class="mrow" id="MathJax-Span-781"><span class="mo" id="MathJax-Span-782" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="msubsup" id="MathJax-Span-783"><span style="display: inline-block; position: relative; width: 0.75em; height: 0px;"><span style="position: absolute; clip: rect(3.337em 1000.36em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-784" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.309em; left: 0.348em;"><span class="mi" id="MathJax-Span-785" style="font-size: 50%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mi" id="MathJax-Span-786" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(0.865em 1004.09em 1.268em -1000.01em); top: -1.319em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.084em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.095em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.29em; border-left: 0px solid; width: 0px; height: 3.525em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo stretchy="false">(</mo><mi>y</mi><mo>=</mo><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>θ</mi><mi>T</mi></msup><mi>x</mi></mrow></msup><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>θ</mi><mi>T</mi></msup><mi>x</mi></mrow></msup></mrow></mfrac><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><msup><mi>θ</mi><mi>T</mi></msup><mi>x</mi></mrow></msup></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-31">P(y=1|x) = \frac{e^{\theta^T x}}{1+e^{\theta^T x}} = \frac{1}{1+e^{-\theta^T x}} </script></p>
<p>可以看到，这个概率和逻辑回归中的形式是一样的。这种情况下GNB 和 LR 会学习到同一个模型。实际上，在更一般的假设（P(x|y)的分布属于指数分布族）下，我们都可以得到类似的结论。</p>
<h3 id="-softmax-">多分类（softmax)</h3>
<p>如果<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-787" style="width: 0.693em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.52em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.67em 1000.53em 2.705em -1000.01em); top: -2.297em; left: 0em;"><span class="mrow" id="MathJax-Span-788"><span class="mi" id="MathJax-Span-789" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.356em; border-left: 0px solid; width: 0px; height: 0.938em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-32">y</script>不是在[0,1]中取值，而是在<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-790" style="width: 1.153em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.923em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.44em 1000.93em 2.475em -1000.01em); top: -2.297em; left: 0em;"><span class="mrow" id="MathJax-Span-791"><span class="mi" id="MathJax-Span-792" style="font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.01em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-33">K</script>个类别中取值，这时问题就变为一个多分类问题。有两种方式可以出处理该类问题：一种是我们对每个类别训练一个二元分类器（One-vs-all），当<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-793" style="width: 1.153em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.923em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.44em 1000.93em 2.475em -1000.01em); top: -2.297em; left: 0em;"><span class="mrow" id="MathJax-Span-794"><span class="mi" id="MathJax-Span-795" style="font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.01em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-34">K</script>个类别不是互斥的时候，比如用户会购买哪种品类，这种方法是合适的。如果<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-796" style="width: 1.153em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.923em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.44em 1000.93em 2.475em -1000.01em); top: -2.297em; left: 0em;"><span class="mrow" id="MathJax-Span-797"><span class="mi" id="MathJax-Span-798" style="font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.01em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-35">K</script>个类别是互斥的，即 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-799" style="width: 2.762em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.187em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.497em 1002.14em 2.705em -1000.01em); top: -2.297em; left: 0em;"><span class="mrow" id="MathJax-Span-800"><span class="mi" id="MathJax-Span-801" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-802" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mi" id="MathJax-Span-803" style="font-family: MathJax_Math-italic; padding-left: 0.29em;">i</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.356em; border-left: 0px solid; width: 0px; height: 1.225em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>=</mo><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-36">y = i</script> 的时候意味着 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-804" style="width: 0.693em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.52em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.67em 1000.53em 2.705em -1000.01em); top: -2.297em; left: 0em;"><span class="mrow" id="MathJax-Span-805"><span class="mi" id="MathJax-Span-806" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.356em; border-left: 0px solid; width: 0px; height: 0.938em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-37">y</script> 不能取其他的值，比如用户的年龄段，这种情况下 Softmax 回归更合适一些。Softmax 回归是直接对逻辑回归在多分类的推广，相应的模型也可以叫做多元逻辑回归（Multinomial Logistic Regression）。模型通过 softmax 函数来对概率建模，具体形式如下：</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/munderover&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-807" style="width: 13.454em; display: inline-block; margin-left: 2.016em;"><span style="display: inline-block; position: relative; width: 10.753em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(0.463em 1010.76em 3.912em -1000.01em); top: -2.297em; left: 0em;"><span class="mrow" id="MathJax-Span-808"><span class="mi" id="MathJax-Span-809" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.118em;"></span></span><span class="mo" id="MathJax-Span-810" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-811" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-812" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mi" id="MathJax-Span-813" style="font-family: MathJax_Math-italic; padding-left: 0.29em;">i</span><span class="texatom" id="MathJax-Span-814"><span class="mrow" id="MathJax-Span-815"><span class="mo" id="MathJax-Span-816" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-817" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-818" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-819" style="font-family: MathJax_Math-italic; padding-left: 0.175em;">θ</span><span class="mo" id="MathJax-Span-820" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-821" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mfrac" id="MathJax-Span-822" style="padding-left: 0.29em;"><span style="display: inline-block; position: relative; width: 3.739em; height: 0px; margin-right: 0.118em; margin-left: 0.118em;"><span style="position: absolute; clip: rect(2.82em 1001.68em 4.199em -1000.01em); top: -4.711em; left: 50%; margin-left: -0.859em;"><span class="msubsup" id="MathJax-Span-823"><span style="display: inline-block; position: relative; width: 1.67em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.41em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-824" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.463em;"><span class="texatom" id="MathJax-Span-825"><span class="mrow" id="MathJax-Span-826"><span class="msubsup" id="MathJax-Span-827"><span style="display: inline-block; position: relative; width: 0.75em; height: 0px;"><span style="position: absolute; clip: rect(3.337em 1000.36em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-828" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.509em 1000.41em 4.199em -1000.01em); top: -4.309em; left: 0.348em;"><span class="mi" id="MathJax-Span-829" style="font-size: 50%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.509em 1000.24em 4.199em -1000.01em); top: -3.849em; left: 0.348em;"><span class="mi" id="MathJax-Span-830" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mi" id="MathJax-Span-831" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(2.82em 1003.63em 4.602em -1000.01em); top: -2.986em; left: 50%; margin-left: -1.779em;"><span class="mrow" id="MathJax-Span-832"><span class="munderover" id="MathJax-Span-833"><span style="display: inline-block; position: relative; width: 1.785em; height: 0px;"><span style="position: absolute; clip: rect(3.107em 1000.99em 4.429em -1000.01em); top: -4.021em; left: 0em;"><span class="mo" id="MathJax-Span-834" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.394em 1000.7em 4.199em -1000.01em); top: -4.481em; left: 1.038em;"><span class="mi" id="MathJax-Span-835" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.394em 1000.36em 4.372em -1000.01em); top: -3.734em; left: 1.038em;"><span class="mi" id="MathJax-Span-836" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="texatom" id="MathJax-Span-837" style="padding-left: 0.175em;"><span class="mrow" id="MathJax-Span-838"><span class="msubsup" id="MathJax-Span-839"><span style="display: inline-block; position: relative; width: 1.67em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.41em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-840" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.423em; left: 0.463em;"><span class="texatom" id="MathJax-Span-841"><span class="mrow" id="MathJax-Span-842"><span class="msubsup" id="MathJax-Span-843"><span style="display: inline-block; position: relative; width: 0.75em; height: 0px;"><span style="position: absolute; clip: rect(3.337em 1000.36em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-844" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.509em 1000.41em 4.199em -1000.01em); top: -4.309em; left: 0.348em;"><span class="mi" id="MathJax-Span-845" style="font-size: 50%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.509em 1000.24em 4.314em -1000.01em); top: -3.849em; left: 0.348em;"><span class="mi" id="MathJax-Span-846" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mi" id="MathJax-Span-847" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(0.865em 1003.75em 1.268em -1000.01em); top: -1.319em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.739em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.095em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.865em; border-left: 0px solid; width: 0px; height: 4.028em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo stretchy="false">(</mo><mi>y</mi><mo>=</mo><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo>,</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><msubsup><mi>θ</mi><mi>i</mi><mi>T</mi></msubsup><mi>x</mi></mrow></msup><mrow><munderover><mo>∑</mo><mi>j</mi><mi>K</mi></munderover><mrow class="MJX-TeXAtom-ORD"><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><msubsup><mi>θ</mi><mi>j</mi><mi>T</mi></msubsup><mi>x</mi></mrow></msup></mrow></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-38"> P(y=i|x, \theta) = \frac{e^{\theta_i^T x}}{\sum_j^K{e^{\theta_j^T x}}} </script></p>
<p>而决策函数为：<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;argmax&lt;/mtext&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-848" style="width: 14.202em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.327em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.383em 1011.22em 2.705em -1000.01em); top: -2.297em; left: 0em;"><span class="mrow" id="MathJax-Span-849"><span class="msubsup" id="MathJax-Span-850"><span style="display: inline-block; position: relative; width: 0.98em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.47em 4.429em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-851" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.578em;"><span class="mo" id="MathJax-Span-852" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mo" id="MathJax-Span-853" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="msubsup" id="MathJax-Span-854" style="padding-left: 0.29em;"><span style="display: inline-block; position: relative; width: 3.567em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1003.23em 4.429em -1000.01em); top: -4.021em; left: 0em;"><span class="texatom" id="MathJax-Span-855"><span class="mrow" id="MathJax-Span-856"><span class="mtext" id="MathJax-Span-857" style="font-family: MathJax_Main;">argmax</span></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -3.791em; left: 3.28em;"><span class="mi" id="MathJax-Span-858" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mi" id="MathJax-Span-859" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.118em;"></span></span><span class="mo" id="MathJax-Span-860" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-861" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-862" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mi" id="MathJax-Span-863" style="font-family: MathJax_Math-italic; padding-left: 0.29em;">i</span><span class="texatom" id="MathJax-Span-864"><span class="mrow" id="MathJax-Span-865"><span class="mo" id="MathJax-Span-866" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-867" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-868" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-869" style="font-family: MathJax_Math-italic; padding-left: 0.175em;">θ</span><span class="mo" id="MathJax-Span-870" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.356em; border-left: 0px solid; width: 0px; height: 1.369em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>y</mi><mo>∗</mo></msup><mo>=</mo><msub><mrow class="MJX-TeXAtom-ORD"><mtext>argmax</mtext></mrow><mi>i</mi></msub><mi>P</mi><mo stretchy="false">(</mo><mi>y</mi><mo>=</mo><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo>,</mo><mi>θ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-39">y^* = \textrm{argmax}_i P(y=i|x,\theta)</script></p>
<p>对应的损失函数为：</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mfrac&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/munderover&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/munderover&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mfrac&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-871" style="width: 21.215em; display: inline-block; margin-left: 2.016em;"><span style="display: inline-block; position: relative; width: 16.961em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(0.405em 1016.97em 3.797em -1000.01em); top: -2.297em; left: 0em;"><span class="mrow" id="MathJax-Span-872"><span class="mi" id="MathJax-Span-873" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-874" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-875" style="font-family: MathJax_Math-italic;">θ</span><span class="mo" id="MathJax-Span-876" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-877" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mo" id="MathJax-Span-878" style="font-family: MathJax_Main; padding-left: 0.29em;">−</span><span class="mfrac" id="MathJax-Span-879"><span style="display: inline-block; position: relative; width: 1.038em; height: 0px; margin-right: 0.118em; margin-left: 0.118em;"><span style="position: absolute; clip: rect(3.165em 1000.41em 4.199em -1000.01em); top: -4.711em; left: 50%; margin-left: -0.227em;"><span class="mn" id="MathJax-Span-880" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.165em 1000.88em 4.199em -1000.01em); top: -3.331em; left: 50%; margin-left: -0.457em;"><span class="mi" id="MathJax-Span-881" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(0.865em 1000.99em 1.268em -1000.01em); top: -1.319em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.038em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.095em;"></span></span></span></span><span class="munderover" id="MathJax-Span-882" style="padding-left: 0.175em;"><span style="display: inline-block; position: relative; width: 1.44em; height: 0px;"><span style="position: absolute; clip: rect(2.877em 1001.39em 4.659em -1000.01em); top: -4.021em; left: 0em;"><span class="mo" id="MathJax-Span-883" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.394em 1000.24em 4.314em -1000.01em); top: -2.929em; left: 0.578em;"><span class="mi" id="MathJax-Span-884" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.28em 1000.64em 4.199em -1000.01em); top: -5.171em; left: 0.405em;"><span class="mi" id="MathJax-Span-885" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="munderover" id="MathJax-Span-886" style="padding-left: 0.175em;"><span style="display: inline-block; position: relative; width: 1.44em; height: 0px;"><span style="position: absolute; clip: rect(2.877em 1001.39em 4.659em -1000.01em); top: -4.021em; left: 0em;"><span class="mo" id="MathJax-Span-887" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.394em 1000.3em 4.429em -1000.01em); top: -2.929em; left: 0.578em;"><span class="mi" id="MathJax-Span-888" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.28em 1000.64em 4.199em -1000.01em); top: -5.171em; left: 0.405em;"><span class="mi" id="MathJax-Span-889" style="font-size: 70.7%; font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="texatom" id="MathJax-Span-890" style="padding-left: 0.175em;"><span class="mrow" id="MathJax-Span-891"><span class="mn" id="MathJax-Span-892" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-893" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-894"><span style="display: inline-block; position: relative; width: 0.808em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.47em 4.429em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-895" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -3.849em; left: 0.52em;"><span class="mi" id="MathJax-Span-896" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mo" id="MathJax-Span-897" style="font-family: MathJax_Main; padding-left: 0.29em;">=</span><span class="mi" id="MathJax-Span-898" style="font-family: MathJax_Math-italic; padding-left: 0.29em;">j</span><span class="mo" id="MathJax-Span-899" style="font-family: MathJax_Main;">]</span><span class="mi" id="MathJax-Span-900" style="font-family: MathJax_Main; padding-left: 0.175em;">log</span><span class="mo" id="MathJax-Span-901"></span><span class="texatom" id="MathJax-Span-902" style="padding-left: 0.175em;"><span class="mrow" id="MathJax-Span-903"><span class="mfrac" id="MathJax-Span-904"><span style="display: inline-block; position: relative; width: 3.05em; height: 0px; margin-right: 0.118em; margin-left: 0.118em;"><span style="position: absolute; clip: rect(2.82em 1001.68em 4.199em -1000.01em); top: -4.711em; left: 50%; margin-left: -0.859em;"><span class="msubsup" id="MathJax-Span-905"><span style="display: inline-block; position: relative; width: 1.67em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.41em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-906" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.463em;"><span class="texatom" id="MathJax-Span-907"><span class="mrow" id="MathJax-Span-908"><span class="msubsup" id="MathJax-Span-909"><span style="display: inline-block; position: relative; width: 0.75em; height: 0px;"><span style="position: absolute; clip: rect(3.337em 1000.36em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-910" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.509em 1000.41em 4.199em -1000.01em); top: -4.309em; left: 0.348em;"><span class="mi" id="MathJax-Span-911" style="font-size: 50%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.509em 1000.24em 4.199em -1000.01em); top: -3.849em; left: 0.348em;"><span class="mi" id="MathJax-Span-912" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mi" id="MathJax-Span-913" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(2.935em 1002.94em 4.429em -1000.01em); top: -3.101em; left: 50%; margin-left: -1.434em;"><span class="mrow" id="MathJax-Span-914"><span class="mo" id="MathJax-Span-915" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span class="texatom" id="MathJax-Span-916" style="padding-left: 0.175em;"><span class="mrow" id="MathJax-Span-917"><span class="msubsup" id="MathJax-Span-918"><span style="display: inline-block; position: relative; width: 1.67em; height: 0px;"><span style="position: absolute; clip: rect(3.394em 1000.41em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-919" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; top: -4.309em; left: 0.463em;"><span class="texatom" id="MathJax-Span-920"><span class="mrow" id="MathJax-Span-921"><span class="msubsup" id="MathJax-Span-922"><span style="display: inline-block; position: relative; width: 0.75em; height: 0px;"><span style="position: absolute; clip: rect(3.337em 1000.36em 4.199em -1000.01em); top: -4.021em; left: 0em;"><span class="mi" id="MathJax-Span-923" style="font-size: 70.7%; font-family: MathJax_Math-italic;">θ</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.509em 1000.41em 4.199em -1000.01em); top: -4.309em; left: 0.348em;"><span class="mi" id="MathJax-Span-924" style="font-size: 50%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(3.509em 1000.3em 4.199em -1000.01em); top: -3.849em; left: 0.348em;"><span class="mi" id="MathJax-Span-925" style="font-size: 50%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span><span class="mi" id="MathJax-Span-926" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.027em;"></span></span><span style="position: absolute; clip: rect(0.865em 1003.06em 1.268em -1000.01em); top: -1.319em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.05em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.095em;"></span></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.302em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.721em; border-left: 0px solid; width: 0px; height: 3.956em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>∑</mo><mi>i</mi><mi>N</mi></munderover><munderover><mo>∑</mo><mi>j</mi><mi>K</mi></munderover><mrow class="MJX-TeXAtom-ORD"><mn>1</mn><mo stretchy="false">[</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mi>j</mi><mo stretchy="false">]</mo><mi>log</mi><mo>⁡</mo><mrow class="MJX-TeXAtom-ORD"><mfrac><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><msubsup><mi>θ</mi><mi>i</mi><mi>T</mi></msubsup><mi>x</mi></mrow></msup><mrow><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><msubsup><mi>θ</mi><mi>k</mi><mi>T</mi></msubsup><mi>x</mi></mrow></msup></mrow></mrow></mfrac></mrow></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-40">J(\theta) = -\frac{1}{N} \sum_i^N \sum_j^K {1[y_i=j] \log{\frac{e^{\theta_i^T x}}{\sum {e^{\theta_k^T x}}}}}</script></p>
<p>类似的，我们也可以通过梯度下降或其他高阶方法来求解该问题，这里不再赘述。</p>
<h2 id="-">应用</h2>
<p>本文开始部分提到了几个在实际中遇到的问题，这里以预测用户对品类的购买偏好为例，介绍一下美团是如何用逻辑回归解决工作中问题的。该问题可以转换为预测用户在未来某个时间段是否会购买某个品类，如果把会购买标记为1，不会购买标记为0，就转换为一个二分类问题。我们用到的特征包括用户在美团的浏览，购买等历史信息，见下表</p>
<table>
<thead>
<tr>
<th style="text-align:left">类别</th>
<th style="text-align:left">特征        </th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">用户</td>
<td style="text-align:left">购买频次，浏览频次，时间，地理位置 ...</td>
</tr>
<tr>
<td style="text-align:left">品类</td>
<td style="text-align:left">销量，购买用户，浏览用户 ...</td>
</tr>
<tr>
<td style="text-align:left">交叉</td>
<td style="text-align:left">购买频次，浏览频次，购买间隔 ...</td>
</tr>
</tbody>
</table>
<p>其中提取的特征的时间跨度为30天，标签为2天。生成的训练数据大约在7000万量级（美团一个月有过行为的用户），我们人工把相似的小品类聚合起来，最后有18个较为典型的品类集合。如果用户在给定的时间内购买某一品类集合，就作为正例。哟了训练数据后，使用Spark版的LR算法对每个品类训练一个二分类模型，迭代次数设为100次的话模型训练需要40分钟左右，平均每个模型2分钟，测试集上的AUC也大多在0.8以上。训练好的模型会保存下来，用于预测在各个品类上的购买概率。预测的结果则会用于推荐等场景。</p>
<p>由于不同品类之间正负例分布不同，有些品类正负例分布很不均衡，我们还尝试了不同的采样方法，最终目标是提高下单率等线上指标。经过一些参数调优，品类偏好特征为推荐和排序带来了超过1%的下单率提升。</p>
<p>此外，由于LR模型的简单高效，易于实现，可以为后续模型优化提供一个不错的baseline，我们在排序等服务中也使用了LR模型。</p>
<h2 id="-">总结</h2>
<p>逻辑回归的数学模型和求解都相对比较简洁，实现相对简单。通过对特征做离散化和其他映射，逻辑回归也可以处理非线性问题，是一个非常强大的分类器。因此在实际应用中，当我们能够拿到许多低层次的特征时，可以考虑使用逻辑回归来解决我们的问题。</p>
<h2 id="-">参考资料</h2>
<ul>
<li>Trevor Hastie et al. The elements of statistical learning</li>
<li>Andrew Ng, CS 229 lecture notes</li>
<li>C.M. Bishop, Pattern recognition and machine learning</li>
<li>Andrew Ng et al. On discriminative vs. generative classifiers:a comparison of logistic regression and naïve bayes</li>
<li>Wikipedia, <a href="http://en.wikipedia.org/wiki/Logistic_regression">http://en.wikipedia.org/wiki/Logistic_regression</a></li>
</ul>
<div class="hidden-mobile"><br><p><strong>不想错过技术博客更新？想给文章评论、和作者互动？第一时间获取技术沙龙信息？</strong></p><p><strong>请关注我们的官方微信公众号“美团点评技术团队”。现在就拿出手机，扫一扫：</strong></p><img src="./Logistic Regression 模型简介 -_files/qrcode_for_gh.jpg" width="255" height="255" alt="公众号二维码" align="center"></div></div><footer class="article__footer"><div class="meta article__meta"><a href="http://tech.meituan.com/tag/Logistic%20Regression" class="tag"><!--i.fa.fa-tag--><span class="tag_name">Logistic Regression</span></a><a href="http://tech.meituan.com/tag/%E5%88%86%E7%B1%BB" class="tag"><!--i.fa.fa-tag--><span class="tag_name">分类</span></a><a href="http://tech.meituan.com/tag/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0InAction" class="tag"><!--i.fa.fa-tag--><span class="tag_name">机器学习InAction</span></a></div><div class="qr_code_btn_container"><a href="javascript: void(0)" class="qr_code_btn_link"><span class="qr_code_btn"><img src="./Logistic Regression 模型简介 -_files/qr_icon.png"></span></a><div class="qr_code"><div id="qr_code_btn" class="content"><p class="title">关注我们</p><p class="desktop_qr_tittle">扫码关注技术博客</p><img src="./Logistic Regression 模型简介 -_files/qrcode_for_gh.jpg" class="qr_img"><p class="tips">微信搜索 "美团技术团队"</p></div></div><a href="javascript:window.smoothScrollToTop()"><span class="top_btn"></span></a></div></footer></article></div></div><div class="qr_code_btn_container"><a href="javascript: void(0)" class="qr_code_btn_link"><span class="qr_code_btn"><img src="./Logistic Regression 模型简介 -_files/qr_icon.png"></span></a><div class="qr_code"><div id="qr_code_btn" class="content"><p class="title">关注我们</p><p class="desktop_qr_tittle">扫码关注技术博客</p><img src="./Logistic Regression 模型简介 -_files/qrcode_for_gh.jpg" class="qr_img"><p class="tips">微信搜索 "美团技术团队"</p></div></div><a href="javascript:window.smoothScrollToTop()"><span class="top_btn"></span></a></div><footer id="footer"><div id="hide"><a href="javascript:window.smoothScrollToTop()"><img src="./Logistic Regression 模型简介 -_files/top.png"></a></div><div class="ft"><span class="copyright">© 2017 美团点评技术团队</span><span class="copyright">All rights reserved.</span></div></footer><script type="text/javascript">(function() {
    var dis = document.getElementById('hide');
    window.onscroll = function(){
        if(window.scrollY >= 100){
            dis.setAttribute('Id', 'toTop');
        }else{
            dis.setAttribute('Id', 'hide');
        }
    }
    
    
})()
function changeShowYear(e){
    var ele = e.target;
    if(ele.tagName !== "SPAN"){
        return;
    }
    var text = ele.innerHTML;
    var yearTags = document.querySelectorAll(".year_header span");
    
    for(var i in yearTags){
        if(yearTags.hasOwnProperty(i)){
            yearTags[i].setAttribute("class", "enable_year");
        }
    }
    ele.setAttribute("class", "active_year");        
    
    var queryFlag = "[data-year='" + text + "']";
    var allList = document.querySelectorAll(".post-list");
    var showYearEle = document.querySelector(queryFlag);
    
    for(var i in allList){
        if(allList.hasOwnProperty(i)){
            allList[i].setAttribute("class", "post-list hide");
        }
    }
    showYearEle.setAttribute("class", "post-list active");
}

var tagYear = document.querySelector(".year_header");
if(tagYear){
    tagYear.addEventListener("click", changeShowYear, false);
}</script><script>var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-55279261-1']);
_gaq.push(['_trackPageview']);
(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Size2, sans-serif;"></div></div></body></html>