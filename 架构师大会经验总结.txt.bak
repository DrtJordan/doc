3par 8200/8450 
nginx+memcache Ȼķֲʽ洢 ʺCDN
squid Խ޴Լʵһڴҳ/ҳĹϵͳڴswapʵlinuxںѾúܺãsquidĶһٷӰ
varnishڴȫںˣݳڴֵʱں˻Զһֻswapóڴ档Ųһұľ飬1̨varnishԵ6̨squidܡ
nginx cache֪˵ʺϻ洿ıСݣnginx⹻ϴһɽկvarnish¡
Աʹtengine+squidĴcdnϵͳ洢ϵͳԼڸ㣬

Venusܺݣݿʲװַֿ֧⡢ֱ ӳŻ
棨Redis/Memcachedӿڷװ Ż
CRUDԶɣݿ
OSP/RESTýӿڷװ첽֧
ValidateInternals
ԪɲģԶ

ĵ
JSFṩǿķܣķ顢ߡڰ·ɵȣҲ綯̬顢ͬȡ·Ȩõȵȹܣҿ˲ַAPIеá

·ͬʱͨһ HTTP/2 ӷص-ӦϢ
֪  HTTP/1.1 Э ͻͬһʱ䣬ͬһµһơĿᱻ
ڶƷ֡У HTTP/2 ὫдϢָΪСϢ֡frame,ǲöƸʽı  HTTP1.x ײϢᱻװ HEADER frameӦ Request Body װ DATA frame 档
HTTP/2 ͨŶһɣӿԳ˫
ڹȥ HTTP ŻĹؼڸߴǵӳ١TCP ӻʱҡгӵٶȣݳɹ䣬ʱߴٶȡֵг򱻳Ϊ TCP ԭԭ;ͻԺͶʱԵ HTTP ӱʮֵЧ
HTTP/2 ͨͬһӣԸЧʹ TCP ӣøߴҲķ HTTP 
HTTP/2 ʹרΪײѹƵ HPACK 㷨
 HTTP/2 УԶԿͻ˵һͶӦ
Ŀǰ֧ HTTP/2  Chrome 41+Firefox 36+Safari 9+Windows 10 ϵ IE 11  Edge F5H2Onghttp2 ʮѡ񣬸ʵֵĶСNginx ԽһЩڡ³ṩ HTTP/2 ʵ֧֡

OpenResty ҲΪ ngx_openrestyһȫܵ Web Ӧ÷˱׼ Nginx ģܶĳõĵģ飬ԼǵĴ
 ͨڶƵ Nginx ģ飬OpenResty Чذ Nginx תΪһǿ Web Ӧ÷Աʹ Lua Զ Nginx Լеĸ Nginx C ģнụ̋Դһϲļ˸ܵ Web Ӧá
 OpenResty ڽķӦȫ Nginx У Nginx ¼ģз I/O ͨšǺ HTTP ͻ˼ͨǷģMySQLPostgreSQLMemcachedԼ Redis ڶԶ֮ͨҲǷġ
 Ϊ OpenResty άҲд Nginx ģߣ OpenResty ȷԿɿЭͬ
Nginx Ƕ˹˷ģ Lua ǰڷģйഺ LuaJIT VM Ƕ뵽 Nginx Уʵ OpenResty ܷ˽
node.js ĻصGo ĵԲ

дͬķʽϵͳԶ첽С

һõļܹҪӦҵ
ͬʱͨûģ飬ͨòȶͨģ
֮Ϲ㣬㴦Ӷҵ
Ҷ䡣

Hedwigṩ˷Զעᷢ֡
⡢ڵ߳븴̬߼顢
ԶԵڶSOAǿܣ֧
󡢻Ҷȷ䱳ṩĵ·
ιϵ־ԤȸΪSOA
ǿĺڱ
  
1SWeb࣬H5·ϼ
鷽ϵһָָ꣬1)ǿ
(4G/WIFI)£1ȫҳأ
Դɿ;2)3G1װķ
;3)2G1ɽ

ڵ㣺HttpDNSŻ
DNS൱ɹۣ2G5-10s3Gƽ
ҲҪ3-5s
 ԿһHttpDNS
߶˵봫ͳUDPЭDNS
ͬHttpDNSHTTPЭ顣HTTP
ֵʱ䲢DNSٳֵ
⡣

ĽǣSSL֮SPDYĬϿ
SPDYЭµĴЧʺͽЧ潫
SPDYЭ£Դ
webviewĲƣ100+ǿ
ġ
 ͬʱڱ֤֮ͬµ
Դ󽫿ȫõһεDNSSSL
֣ԣڵһĵʱȫԱSPDY
ԴЧʣԼӸ
öȴ油ϣԽӵ
ҳ棬ԴԽSSL+SPDY֮
Խ

1.ͼƬԴȫgw.alicdn.com;
2.ǰͼƬǿ豸ֱ;
3.ݺϲΪһ

ͨTraceView߷APPԴ
joomla,drupal,wordpresscms
СĿ  ڵϲԵĳ ̳discuz ecshop

˫
MySQL˫дӦҵĿϢͬ
ҵʹҪҵҪֶ֮ضҵʽԽԽãֻҵ
 ʹõԪûǶȽеԪҲͬһڿɣɺͬݵҺƷάȣȻҪά־ݣҵķķܻɢڶģȻҪڶɣҲǱжڵķãԶԶҺƷʲôҪڲͬݣ֤ݵһ⣬˵Դﵽ1ڵͬﲢûйôġ
 ݻн40msʱ

ܵ˵ChefPuppetDockerҪDevOpsߣֱռ32%32%Լ27%


ELK־stack  elasticsearch()+logstash(ռ)+kibana(ʾ)

Flumeһֲʽɿ͸߿õĺ־ۺϵϵͳ֧ϵͳжƸݷͷռݣͬʱFlumeṩݽм򵥴дݽܷɶƣ
finagle twitterԴrpcܣnetty 

Consul Դķע
Hystrix Դķݴ
Eureka is Netflixs middle-tier, load balancing and discovery service. 

LinkedIn  Scala  Node.js
node.js ĿǰȽʺʵָ߲IOϵͳʺϸCPU/ڴ
DDD=ģƣ=+ҵ񷽷ۺһ?  ģһ ľǹĵȷҵĶ󣬶ݿ
CQRS=Command'Query'Responsibility'Segrega6on д룬actorֱ״̬߼Ͳѯ߼򵥿չ ݶڿܲһ

ÿactorԼmesasge queue
Actor Model is comprised by 3 distinct pieces:
A behavior
An address
A mailbox
ReactorģʽбDispatcherߡNotifier
actorһʵ壬յϢʱԲִ²
1. Ϣactor
2. actor
3. ָյһϢʱΪ

reactorͨע/صʽĳ򿪷ģʽעԼעʲô¼ȻӦѾͻڸ¼ʱص㡣ʵactor ģЩơ
reactorһģʽһ벢һʱ¼յַͬӦϡ


proactorģͿΪreactorģ͵һ첽ʵ֣reactorҪյReactorProactorģʽҪĶȡд˭ɵģReactorҪӦóԼȡдݣProactorģʽУӦóҪʵʵĶдֻ̣Ҫӻȡд뼴ɣϵͳȡд뻺IO豸.ַͬϣproactor첽 

like JQuery rather than javascript

When to choose Akka

Have lots of consumers (think millions).
Need low latency
Open to the Actor concurrency model
Example system: An interactive real time chat system

When to choose MQ

Need to integrate with lots of different systems (ie non JVM)
Message reliability is more important than latency
Would like more tools and admin UI
Because of previous points better for long running tasks
Would like to use a different concurrency model than Actors
 
 scala ҾòǺ scala йأһô߽׳ԱںԲѲѵģΪΪ۵⡣scala  java ףǲ˰Ȼ jvm ˣβֱһ java £˻ǻʩɱǿԤ½ܾð scala  clojure ã˳ɱôߣôСԣɱǲ֮ܳܵʹ nodeΪĿV82ڹѡ͵ʱֱӷ̣󹤳̵ģѡôϽļǰҪͲһʡôһν fullstack ɱάɱַӽ
AkkaõForkjoinpool̳߳صĵԼJVMŻĹؼ

 netty 4Ҳ˶multicast
 
Զsharding hibernate shardsguzzhalo-dalibatis-shardingcobarmysql proxytddl,mycat (latest)

ôŶӣĿ
1.սŶӣһרܣŶӵķչ͸˵ķչͳһôиĳɳռս,ŬÿԼȤʤε,̻֮
2.淶׼(,CI/CD,Զ)
3.ٵ,û翴(mock,page) ʵֺĹܣߣٵ
4. ͨЭûԤڣץСڿteamĽӿں͹,ϸһ,daily buildʱreview ȣ⣬
5.Ŷս,full stack
6.(ʱ䰲ţϵͳжҪ)
7.ĿҪעĹ,淶,reviewȣϿز
8.רҵǿ
ĿҪһǸƣʱ̰Ŀ򣬱֤Ŀƻ˳ִУƫڿɿطշΧڡ
10Ŀźţ1һ̫๦ܣ2̫¼ƽ̨3빫˾һзĲƷ4Ŷֲ㣻5ӵ⣬ҪӵĽⷨ6Աʼؽʵԭ򣻣7ϸġӵ󣻣82.0 ֢ȺҪ󡢸ǿ9Ʒûг㣻10޷Ĵ




DevOpsıòͬ˹ͬЭʵֿٿɿ
DevOpsּڴƿŶάŶ֮ıݵһγԣ߶ڳɹ˵Ǳزٵģͨᱻڲͬ֯ԪУ
໥ִĿꡣڿ߸𽻸ԼԱеʱάԱͼйƽУǽͷյһЧֶΡ

consul һgoдRaftʵ(Raft 㷨֤һ, ȸӵ Paxos 㷨ֱ)ܹģZKֿ֧ģΪдЧʵ
ڷֲʽϵͳУιڵ״̬һֱһ⣬etcdרΪȺķֺעƣṩTTLʧЧݸıӡֵĿ¼ֲʽԭӲȹܣ
ԷĸٲȺڵ״̬etcdĿǰİ汾0.4.5Ȼδ1.0汾ᷢѾʹڶϵͳУɼȳ̶ȡ
etcdCoreOSĺڵķֺù

һ򵥵ʵǽжԴϵͳУʹӦóʩıơ׷١ͬʱҪͨԶ֤Щ֤ͨſɷС

Hedwig ṩ˷Զעᷢ֡ؾ⡢ڵ߳븴̬߼顢ԶԵڶSOAǿܣֲ֧󡢻Ҷȷ䱳ṩĵ·ιϵ
־ԤȸΪSOAṩǿĺڱϡ

ΪӦóĹ벿ʵԶͬҲʮҪģܼӿ̵УܹͽʱΪķա

һʵϣŶʵֵģһƵıػͨٿĲ죬ÿܹҵڡĻĲһЩӣ
WindowsϿеLinuxϲ𣻻ڲͬݿϵͳӦ÷ʹòͬ汾Ŀ⼰
DevOps=ʵ ҪCI(continous integration)/CD (continous deploy)
һ㽫ʩ뻯ܹʹð汾ƶԻʩı׷١㻹ڲܵмĲ裬ʵֽӿ̵Զ

ٲģʽ,ݿ̵һԭԸƵʽС,õݵĿԵÿSprintĵĩβ߱ԽĹܡ
ĸƵʾᵼ²ѻITάǰ
DevOpsAgile죬AilgeDev & BizŽЭͨķʽ⡣DevOpsһ쵽ITάͨDev & OpsĽЭƵʡ

DevOpsĿǴ׼ġظġȫԶDelivery Pipeline,䷶Χƣ𣬲ԺͷƺͿ⣬ĸ趼ǿԶġ
Զ߿ɲԣһԣȶԺͽƵʵĺ
ͻ˸ؾⲢNetflixġǣĹ˾һڻܹȫʹּ

DevOps
Configuration in code
? Standardized environments
? Linux containers
? Automated provisioning
 Continuous integration/ Continuous delivery
 
 ݺͳԼǿЩͬʱΪITά룬ΪøDevOpsصĿٲĽ࣬ITIL̵ĺܶ෽棬رΧűúͷ̷棬ҪԶ
 ɵĺǼȱ룬ֺ޸֮ʱ
 1. ɵһף뼶ļɡļɲĳɹҲʵ֣һԵbuild߻ãjavamavengradlegoõbuild 
   ֻ뻹⣬˴飬̬ԪԵãԸʼȵǿܡ
 2.ɵĵڶףworkflowŻʵĳɡ ɲ unit/functional
 3.ɵĵף뽻
 
 Ϊһǣڴͳģʽ£ITĳPetsȡ֣ĸ󣬵ˣΪβ
 ̬Ӧ÷ģУũеĹţͨǱţˣɱһͷţ
ʹ࣬Ƶ


Scrumľ㣬һǶ̵ڶ֯
̵ŶӿγɽУÿллع飬һߡȴͳٲ̣ΪȱķƣŶӵĸĽѡ
֯ĿŶӶĿҳŵŶԴĿꡣڹ˾Ȩ֯ʵеСģĽǿĹʦŶӣ൱ЧҲȱ㣬
ǾŶʶܹǿ¿ŶӺ⡣

ʵ㣬ScrumĽǷǳġرǶ̵
һ̵ڲƣڽĵҪд
ڶ̵ûʱȫĻعԣbug

ΪЧĽ⣬ScrumһЩؼĹʵ
һҪģǲԶǵԪԻǹܲԣڶ̵±֤ҪΨһֶΡ
ڶعԶԣŶӦ¸ҵĲع룬ծ
ɡԶԣɿ̵ʱڱ⣬ҪŶӽCIĴΪȼ
 
Hadoop̬ѾתƵYarnϡYarn̫ʺϷHadoopĻ
 
ʹDockerfileDockerһĿǰΨһеķӻSSHһϸĵľádocker pushһֻһDockerĳЩط
ǻǱȽ鷳ֶ񣿲ǰɣ㲻ܻ20ǰãֻͨıصOSDockerͬһֻˡ 


 Mesos=GoogleֲʽϵͳBorgĿԴʵְ汾 ,googleҲһKubernetes


zabbix˵ü򵥣webþˣnagiosԱȽ鷳zabbix߶ȼ
agiosɺܶɡҪصĻʵʤΡ
nagioszabbix֣о֮Ҳûɶcactiûϸù
ڻϾûͼ

  ܵʵֽɫṩߡߺעġṩڷõǰ£ַעᵽעġʱᶩעĵط񣬻ȡַͨһĸؾԵ÷עؼȺĴڣṩߺͷ߿ݺߣעĿʵʱṩߵַı͸
ǷܵĺĹܡνָṩѷһµԼ֤ĸܣԽĳЩضĳһԼĳЩǷߵĶʣṩߴﵽһ̶ʱܾµȹܡ
 ֲʽõĸ ֲʽøٵ˼ǶһǰķֲʽöͬһصõEagleEyeͬһʱĳһ̨зкܶ࣬ôʶĸأǿڸõм֡
2013ϰ꣬Ͱͼм˶Ӧ÷ŶӣҪŽӦ÷صĹĿǰڹ˾ڲTomcat


ֲʽչ󣬿ѡʵĽͨͨѶʽ
ӪӣȼӴ,DevOps
һǵϵͳǷֲʽҪǵĶ֮ǰĶöࡪӳ٣ݴϢлɿ磬첽ԣ汾ƣǵӦóȲͬĸ.

νĵܹһŵ㡣ܹӦóǳ׿ΪIDE߶ʺϿӦóЩҲױԣֻһ򼴿ɡܹӦóҲײΪֻ踴ƿԪһļĿ¼һӦĻɡ

ԶԸ÷ʽСȻܹڸӵĳкѼԦһӴĵڿ˵άƵĶĿ˵Ҳһ谭Ϊ˶ĳ޸ģ㲻òͲ൱ӣռҲȽϺʱҪܶ࿪߹ͬЭҪϳĲڡ

ܹҲʹúͲµļѡ磬һµĻʩܶдǷǳѵģֲִʵˣ㾭Ŀʼʱļѡ仰˵ִܹ֧͵ģڳӦó򲢲߱ԡ

ĿǰΪֹӦѾܺõطǣδɻҪáǣģ黯ӦնΪŶ׳󡢳Ա䶯Ӧ÷Χչȳ⡣ǵӦõһЩ㣺

    Ӧóκϸ΢޸ĶҪӦó¹²𡣿ԱҪȵӦóɺܿ仯ԱͬһӦóôҪȴԱ˸ԵĿ⽵ŶӵԺ͹ܽƵʣ
    ӦÿܻȽϴ󣬹ͲʱҲӦرȽϳƵ谭ƶӦÿУԵΪأ
    ܼջƣӦãڿ֮ǰѡģÿŶӳԱʹͬĿԡ־û洢ϢϵͳҪʹƵĹߣ޷ݾĳѡ
    ծ񣺡ޣNot brokendont fixзǳӦˡϵͳƻдõĴ޸ģΪӦóֿܻ֮ķʽʹʱơԱȻӦóļծ

ҵĿٷչ仯ԡԺͿչ󲻶ҪһָӿٸЧʽ΢һֿܹ񡣵ӦñֽɶСķÿԼĹ鵵ļȻͬһӦóġ΢Դԣ˵ķΧ޶ܡ΢ص㣺

    ƣӦóֽܷͨEric EvansڡơȷĹʵ֣ÿŶӸһҵصȫŶӵȫϵеĿԱ߱û桢ҵ߼ͳ־û洢ȷĿܣ
    һְԭÿӦøùܵһĲ֣SOLIDԭ֮һ
    ȷӿڣÿ񶼻ᷢһȷĽӿڣұֲ䣻ֻĽӿڣڱѵķûκ
    չ滻ÿ񶼿Ե²Ӱϵͳʹ÷ÿ񶼿šArt of Scalabilityһ鶨XZչ
    칹/öԣÿʵϸڶ޹أʹ÷ܹ֮ŶӿÿѡʵĿԡ־û洢ߺͷ
    ͨţͨʹͨЭ飬磬ͬREST첽AMQPSTOMPMQTTȡ

Ӧأ΢ŵ㣺

    ڿά
    ȵӦ죻
    ֲ޸ĺײڳɺͳ
    ϸ룬һⲻӰӦã
    κμջԻʩһЩͨǽܳΪNoOpsϽһṩһõӦó̲ȷУơָ֡ͷء
    
http://www.ebaytechblog.com/
http://rdc.taobao.com/team/jm/


20150228
   Pythonиչģ飬϶࣬﷨׶ֿ֧ϴռƣЧʵ£Լɣ̫ĶDLL ʱ
 Luaʱٶռٵ Luaĵٵ   LuaڽĹܺ
 Rubyмõĸ߼  Ruby׵ Ruby﷨Ϊ ĵȱ
 Lua ڸֲﶼ JavaScript 첻 Lua ԭΪǶʽƵģȻ C/C++ ׽ ɱ룬Чʸ
20141121
־ʹ IBM LLM(red hat)
20141112
SPDYЭHTTPּҳļʱ߰ȫԡ
SPDYЭͨѹ·úȼ̼ʱ[1]SPDYĸ֣"speedy"д
SPDYΪGoogle̱[5]

ݽṹ64λܻ
ͨŲشڣһֱACKĳֵͿʼhold ֵΪ1FIX˳ 洰ڣbufferͿʼ
Disruptor һԴĲ ܹʵֲвܿ죬ǳ Ring buffer̴߳cache , RingBufferָ(cursor)עָβԪأһvolatile
Disruptor ArrayBlockingQueue 5ܲ8latency600...

ActorһȺˣǻ֮䲻ؽֻͨʼķʽйͨ
ڴϢʱһActorʵ״̬AkkaȷActorÿʵԼ߳֤ÿֻһϢһ߲ص̬ͬÿActor״̬Աɿر֡
ActorϵͳÿActorļߡActorϢʱʧܣͻͣԼﲢһϢļߣͨ쳣ʽ
Akkaֱܹ֧͸ԣʹActorȫ֪ǽܵϢǴ﷢ , ֧crash-recover  ֲʽļܹ Ϣreplay
Akka ϢFIFOҲԴȼ  Ϣ֧ڷ߼˳֤ÿϢഫһ(ܻᶪ?)
Storm ҲһҪԣAkkaûеģ֤Ϣ
Apache Spark is actually built on Akka

 ʵʱϵͳs4, stormԱֱMQô  𣺺ôˣ 1) Ⱥơ2) 䡣3) ַ 4)  ȵȡ

Ҫ֪StormһĽʹStormҪϢڣ
б״̬÷ֲʽȥЩĳɱܱһĳɱߡ
ǣһ¶ʹStormЩ˵ϸڣܵStormļ򵥣չˡ
supervisord ԶĳkillĻ

RESTSOAӦҲڿ״̬ڹиϢģĻơҪ֧״̬ƲԵǺܲһġܹʦҪʵǷĬѾRESTSOAѡSOAУ״̬פÿһϡ֮Ĺϵͨ߼άԱϢ岻н͡REST״̬ΪϢһִһһ
RESTSOAӦõĵڶǺӿڡڽӿڵİ󶨣ԼԷŸǿĹߡͨRESTful̹󶨻пܵģԽͶ̬󶨣ЩƸ࣬Զδ׼ζŶڸ߶ȶ̬˵SOAҲá
ȻҪԶݿиµ£SOAܴʡSOA׶ύжݿӰѸµ²ŽͺףRESTҪһЩƲԡûһЩ״̬½пɿǲܵģRESTSOAӦǱҪģܻҪһȫSOAʵ֡
ǶƼԡ󲿷ֹԱͨӦóʻVPNģRESTfulӿڲ˺ܴĴٽ
RPC νԶ̵̹ (򷽷)
SOA νļܹ(Ϣ)
REST ν Representational state transfer (Դ)
 RPCԶΪĵ, RESTΪĵ
ͨʹ Netty4 + Thrift ѹƱ뼼ʵ10W TPS1KĸPOJO󣩵ĿڵԶ̷á



RPCϣ΢ƽ̨ǵһзģѷeBayȹTwitterfinagleԱdubboȵȣ
΢ƽ̨2011 PB лʽ cache  db е json ı RPC ߹Уѡ˶ Java ΪѺõ Hessian2 
hessianһڽweb serviceļ򵥵ĶЭ飬XMLweb serviceǽrpcϵģhessianһԼлʽлȻͨhttpЭ鷢͸Դ뷢ʵʹ
RMIʹJavaлHessian/BurlapΪ˲֮ͬͨŶʹ˽ел

Kryo һٸЧJavaͼлܣԭ֧javajavaлgoogleлprotobuf

sqlite android֧unicode  
h2֧trigger/index/mvcc/row lock ֶ֧̲߳
SQLiteһС͵C⣬ʵ˶ģǶģõSQLݿ档԰
 Java  Berkeley DB
h2Thomas MuellerṩһԴġjavaʵֵĹϵݿ
SQLiteڲ̺Ͷ̣߳дһֱ̫
h2һ
Berkeley DB һsql
H2ǼMYSQL ṩһʮַweb̨,ֶ֧汾
ɾܣɾһ¼.SQLiteǳСԺH2ǳСɾ¼SQLite0.078sH2
ѯһ¼ SQLiteҪH2ѯ500010000 H2ҪSQLite
ܣH2Ĳѯ֧һĲԣҪǿSQLite
ܵĿSQLiteҪH2Բ硣
SQLiteһʹCAPIӿڷʣH2֧JDBC
ҶԴƽ̨
mysql in memory engine ֧֧ＰMVCCMyiasmܲ

    Thrift ڳԳ̬ݽҪschemaԤ֪Թ̶
    Avro  Thrift˶schema̬֧ϲThrift AvroHadoop֮Doug Cutting ֧httptcp ,Avroֻavroļ class
    Avro  ʽschemaʹڴݽ洢ͨùߺƽ̨,رں̨
    ĿǰThriftڸֺ֧Գ졣
    Overall, I think Thrift wins on features and Protocol Buffers win on documentation. Implementation-wise, theyre quite similar. 
The major difference is that Thrift provides a full client/server RPC implementation, whereas Protocol Buffers only generate stubs to use in your own RPC system.
Avro֧л뷽ʽƱJSON롣ʹöƱЧллõĽȽС
  avro-rpc 紫㡣ʹNettyNioʵ չĿǰֵ֧лʽAvroJson, Hessian,Javaл
  ThriftProtocol Buffersָ֧ԣ߼ڶչProtocol Buffers£Ŀǰ˵Ӧѵѡ
  thrift RPCԴﵽÿ2ҵĵñgRPCǿ
  
  

NYSE Data Fabric ڿѭ׼LDMALocal Direct Memory Access
RDMAǲûֱInfiBand10GigE ȼƷԣData Fabric ļṩ
ܵϢµͬʱҲԺܷĺе޷ϡ°汾Data Fabric 
LDMA ֧ÿ800 200 ֽڵϢRDMA ֧ÿ160 200 ֽڵϢ
ڿɿUDP ĶಥҲΪ
ϵͳѡرMulticast Э䱾ԸݲͬĶಥַಥ˿ڽзʹ
ȻͶĵԡõĽ£UDP ĿɿԺܸߣʲߣʹһ
ЩUDP ͨЭ磬Reliable UDP Ӧڽϵͳڡ

Block IO 
ļӿѾܴﵽҪֱ֤ͨӶļĿжд
ĽṹֱӽݿԴļĶдЧʣ 
2. ־û
ƵĴ IO Ȼµݶдĳɱߣ֤ͨ־û
ݻ棬أһʱ£ߴ̶дЧʣ

fastDBһǶʽC/C++ڴݿ  JAVA RTSʵʱjava,̵߳Ⱥڴ淽˺ܶŻ
RedHAT MRGʵʱlinux  MGR֣MessagingRealtimeGrid


20140811
ؾ
DNS(F5 3DNS)/http̬ض/BGP(Border Gateway Protocol)Ҳʵֶһvipڶطĸ߿
BGPҪڻASϵͳ֮ĻBGPҪڿ·ɵĴѡõ·
ʹBGPЭ黥Ӫ̵йǸ· 豸жϵIDCIPε·ɣԱ֤ͬӪûĸٷ

Ali RDSͨerlangģErlangʷȴ󲿷˵Ͷ˶ʮˣǰųĸ9

Amazon
Ĺͨrestfulķʽ񿪷֮һ
8-10˵2pizzaܹteam
KISSԭ=keep it simple and stupid 
shared nothingļܹܸõչ
ԼܹȶԺͿɿص
ͳһķʻ
ҪƹʦֻҪṩļԼܹĶ
˭ķ˭СͿͻ๵ܸͨõṩƷ
쿪ԭͣȻһδεѭ޸
Ϣ/첽/ָ(ˮƽֱ)//ͳһķʽӿ//batch䴦/ ķֲʽϵͳ


TengineԱWebĿNginxĻԴվ˺ܶ߼ܺ
ƵĸؾƷSLB߲㸺ؾõLVS+TengineĲ㸺ؾõLVS

Ƽģ绷£ٷLVS⣻
    1LVS֧NAT/DR/TUNNELתģʽģʽڶvlan绷²ʱ˸ӣάɱߵ⣻
    2øؾ豸磬F5ȣLVSȱDDOSܣ
    3LVSPCkeepalivedVRRPЭ޷չ
    4LVSùkeepalivedúͽܲ㣻
Ϊ˽⣬ڹٷLVSϽ˶ƻ
    1תģʽFULLNATʵLVS-RealServervlanͨѶ
    2synproxyȹTCP־λDDOSܣ
    3LVSȺʽ
    4Żkeepalivedܣ

FULLNATʵҪ˼룺local addressipַcip-vipתΪlip->rip lipripΪIDCipԿvlanͨѶ
IN/OUTȫLVSΪ˱֤ף10G
FULLNATתģʽǰ֧TCPЭ飻
NATģʽcip->vip cip->rip ȻripذҲNAT server

LVSȺʽʵֵҪ˼룺LVSOSPFЭ飬ͨECMPȼ·ɣַLVSȺLVSȺתҵ
׳ԣlvsͽospf1vipڼȺLVSϣһ̨LVS downԶֲECMPȼ·޳
չǰLVSȺ޷֧ĳvipLVSȺԽˮƽݣ
Ⱥʽı֤쳣£ؾȶԣ

LVSkeepalivedȫŻ
   Ż첽ģͣselectΪepoolʽ
   Żreloaḍ


ECMPEqual-CostMultipathRoutingȼ۶·ڶͬ·ͬһĿĵַ绷Уʹôͳ·ɼĿĵַݰֻеһ··ڱ״̬Ч״̬ڶ̬·ɻ໥лҪһʱ䣬ֵ··Эڸ绷ͬʱʹö·˴ҿʱ޶رʧЧ·ݴ䡣
ʵֶԶDirector ĸؾ⣿ſӦöˣûOSFPĵȼ۶·ʵ֡ôµˣ֪Director һ̨LINUX/Unix·OSPFЭ飿ʵֵȼ۶·
ʵϾǽģ·̨ʵ·OSPF磬ҪľΪװquaggaصü

ص㣺
14㸺ؾ⣬Чʸ
2.  ü򵥣ֻ谲װlinux·quagga
3.  ޷мؼ飬쳣޷
4.  sessionֵȣܹڼ



http://highscalability.com

ڴ󲿷Ӧó
samba>nfs>glusterfs

mongodb GridFS  mongodbķֲʽļϵͳͨAPIãҲͨfuseʹ
nginxֱӷʶȡmongo gridfs
Gleasyѡ˾ΡѡõMongoDB(Gridfs)ͼ㣬һʱ䷢ֲ֧˶ϵڷƬʱҪHASHIOPSͣѹһCPUͿ100%FASTDFSȷʵֶ֧ϵˣһʱΪʡռļȥļϵͳͬļֻһݣʧʹùл1Sֻܽһļƣʵû취GleasyЭͬдĴ־άɱ̫ߣʹ֮ʼоTFS,HDFSMogileFSʵ飬ԱȣܽᣬGleasyߣǷûһΪʺǡû취ˣ
Mongo GridFSڸ߲ÿд10MСʱһСʱsecondary޷catch up with primary
Mongo GridFSΪֲʽ洢ƵģСҵѾʹMONOGODBҪ洢һЩļҪЩļһЩԪϢ

ڶԴﴦԭϾֲʽ(̫)Բ1pcʽ
ڳõķϢȻinsertݿķʽϢȻinsertݿķʽ
ȿʼϢȻʼݿȻύݿύϢ
ݿʧܣ׳쳣ϢҲԶعΨһķվݿcommit,Ϣrollback
ϢظֻͣҪʱظˡ

2pc 1.нڵסԴסɹظύ 2.ύ ܻΪЭcrashĳڵ㳬ʱ³һֱpending
3pc 1.ѯǷύ 2.ύ򷢳precommit 3.нڵ㶼ack precommit󷢳docommitָ
ڶڵ㳬ʱԶύpending

ύĺǣѯʵʱ򲢲Դ˶ͬˣſʼԴ

GoogleĹڷֲʽ(Large-scale Incremental Processing Using Distributed Transactions and Notifications)ƣҲĸӶȣͬʱҲ֣Ȼͨʹ
15000CPU˴ﵽ˴¼11200 tps (TPC-E benchmark)ƽӦʱΪ2s-5s

Werner VogelsNWRģ(Eventually Consistent - Revisited, By Werner Vogels on December 23, 2008 12:15 AM,   http://www.allthingsdistributed.com/2008/12/eventually_consistent.html)

    NݸƵķ(the number of nodes that store replicas of the data)
    WݸǰҪĽڵ(the number of replicas that need to acknowledge the receipt of the update before the update completes)
    RΪ˶ȡȷҪȡĽڵ(the number of replicas that are contacted when a data object is accessed through a read operation)

Werner Vogels дW+R > NôдڵصܹõµݣǿһԡڴͳһһͬƵĹϵݿУN=2W=2R=1ڷͬģУW1ʱW+R=NһҲ޷֤

KISSԭӢKeep It Simple, Stupid 


˵ Paxos  ĿȺĽĳֵıһ¡Paxos㷨˵Ǹѡٵ㷨ľɸȺͳһκһ㶼Ҫ޸ĳݵ᰸Ƿͨ᰸ȡȺǷгĽͬ⣨Paxos㷨ҪȺеĽǵ
ǿԿԣƺһύŻʵ2PC/3PCǷֲʽһ㷨Ĳдΰ汾Google ChubbyMike Burrows˵ֻһһ㷨Ǿ Paxos 㷨ǲдƷ
һcopy-on-writeķʽдͻд֮ǰcopy,Ȼ޸copyģȻ޸ָʹָµblock

һϵͳ ʱֻһдڵ㣬дڵ崻ܵ10Sҵд
һϵͳָDynamoCassandra֮ϵͳҪ˹ݳͻŵûе

ӳ
L1 cache 0.5ns
L2 cache 7ns 
RAM    100ns 
Send 1M over 	10G network 10ms
Read 1M from RAM 0.25ms
Round trip within datacenter 0.5ms ÿ2000
ms=millsecond(10^3) s=microsecond(10^6) ns=nanosecond (10^9)
disk seek 8-10ms 
disk access/ssd access 8-12/0.1ms
ssd 70us iops  35000 iops д 5000iops  250Mд170M д=ȡ+(512KΪλ)+д룬ԻдŴ
Ҳʱܸߣ2ms
dellĲԵ 75%ʱд½Ϊ1.5msȫյʱ 0.25ms,25% full 0.6 ms 
ssdredoЧǺSAS,commitӦʱ1ϣȡܺúܶ dataܺ

SSDдȽ⣬SSDСд뵥ԪΪ4KBΪҳ(page)дհλʱ԰4KBĵλд룬ҪдĳԪʱҪһĲeraseĵλһ128page512KBÿԪΪ飨blockһհ׵pageдϢʱֱдҪдĳ洢ԪpageݣȽblock뻺棬Ȼ޸ݣblockݣblockд룬ȻSSDдݵĴۺܸߣSSDԣǳ֮Ϊerase-before-write
SLCΪֻһλϢԲд죬ȶMLC2λϢԲдȡȽTLCǱ3λϢԸȶ
ڳʱдMLCдIO½÷ǳSLCȽȶ SLC״̬򵥣ԶȡףMLCж״̬ȡʱ׳ҪУ飬ٶԽ
ΪSSDڡдĥ𡱵⣬ĳԪʱ䱻дʱOracle redoд⣬һSSDʹԱһ⸺ص㷨֤SSDÿԪܹʹãwear levelingΪľ㷨
Wear levelingҲSSDڲFTLʵֵģͨǨﵽĵĿġWear levelingSSDеһֱռ䣬ԭSSDblock poolһfree block poolгأһݳأdata block poolҪдĳpageʱдԭλãȲblockȻдݣдԭλãҪĶǴӿгȡµblockеݺҪдݺϲΪµblockһдµĿհblockԭеblockʶΪinvalid״̬ȴգµblockݳء̨ᶨʱdata blockȡЧݵblockյгСĺôڣһǲᷴдͬһblockдٶȻȽϿ(ʡ˲Ķ)
trimosɾļʱͬʱtrimָssd ƣssdͻǳЩpageѾɾ´ξõʱֱӲдˣcopyĵطڲЬ
gcĄ̊́



15k/m iops >100 ,seek time=10ms  
7.2k/m iops <70 ,seek time=10ms 
non-sqlֻgoogleʵ˷ֲʽ

Amazon DynamoҪϲܻᶪʧݵģʹһģųȥ





ESBһн飬γɷʹ->ESBProxy->ṩߵнڲͬӦивͬ

    н ͻʵʷṩߵݡλáЭͽӿڶ嶼ǲ֪Ҳĵģɴȡҵ߼֮⣬ESBƽ̨ʽ塣ESBƽ̨ʵЭת (WebServiceHttpJMS...)Ϣת (תʵ)Ϣ· (ͬ/첽/ġ·ɡ֧ۺ...)
    н ESBƽ̨Ϊнṩ񽻻еĻESBƽ̨ʵSLA (ɿԱ֤ؾ⣬ƣ棬ƣܴ) (쳣üϢݼ¼ϵͳ״̬أESBù)ͳһȫ (е)
     бγµķESB֧һֱ۵ʽϷ(BPEL  뼶)





ICA CtrixЭ ǿС
RDP MS
SPICE redhat
⻯ķչʹ˳ķչǰҪΪࣺVDIVirtual?Desktop?InfrastructureSBCServer-Based?Computing
SBCԭǽӦͳһװԶ̷ϣûͨͷĻỰԷ漰ӦýзʺͲͬû֮ĻỰǱ˴˸ġ
ˣVDIȽʺڶ湦ƵûʹáûSBCĽӦͳʽһװͲ𵽷ϣȻͬʱṩûʹãнϵ͵Դ󣬵ܸͰȫ뷽ֻܹڵײWindowsϵͳ
PCoIP  Vmware 

1. VDIЭҪ ĿǰOpenStack֧VNCӵRDPӵ.VNCЭ鱾޷USB͸ӡ⣬RDPȻ֧USB͸ǶĳЩUSB豸Uܡ豸ֵ֧Ĳã⣬ᵼжϡ ĿǰõıȽ϶ЭCitrix ICAPCoIPRedHat SpiceĿǰֻSpiceǿԴġ RHEL6SpiceLibvirtѾϣǿԴ汾USB͸ǿ.

CAPԭNOSQLݿĻʯConsistencyһԣAvailabilityԣPartitiontoleranceݴԣ

ݴ(Partition Tolerance)ݴԿΪϵͳڴȻԽ(һԺͿ)
ָĳԭ类ֳɸ򣬶֮以ͨһЩ˽ݴΪϵͳԽڵ㶯̬뿪ĴΪڵļ뿪ΪǼȺڲ

ڴܿؽڵϵͳCAP۵Ķʵĵ£

    һԣܶȡ֮ǰɵдҲҪڲϲ
    ԣдܹں̵ܶʱڷأʹĳ̨˹ϣҲִܹͨУҪȵ߻ϵķԺܳɹ
    ԣܹ崻ֻ֮ͣ߳ϵ쳣

ܿؽڵNOSQLϵͳһһϵͳ崻ʱֹͣܶʱ䣬10sĲд񣬵ǲͣҷָʱԽԽáNOSQLϵͳǶһݱݣͬһʱֻһΪṩдΪͬݵдеıݶṩȡṩ֤ǿһԵĶ񡣵ڻʱҪһʱԭĸݽṩд

AmazonP2PȥĻϵͳṩҪͻϲһԣCassandraеġlast write winsͻϲԣȻȷʵܹܶ⡣ϵͳܹͨûNWRȨһԺͿԣ̨崻ʱд񶼲ֹͣ


LXCΪLinux ContainerļдLinux Containerһں⻯ṩ⻯Ա̺ԴҲҪṩָͻԼȫ⻯ԡ൱C++еNameSpaceЧؽɵϵͳԴֵУԸõڹ֮ƽгͻԴʹ봫ͳ⻯ȣڣ
1ʹͬһںˣС
2Ҫָģ⣻
3Ҫʱ(Just-in-time)룻
4CPUĵıָҪκרŵĽͻƣ
5׼⻯ϵͳ滻еĸԣ
6룬ڸͬʱṩƣʵԴ
ܽ᣺Linux Containerһ⻯ֶΡ
Linux Containerṩڵһɿڵֶ֧໥server containerͬʱִеĻơLinux ContainerеchrootṩһӵԼ̺ռ⻷бΪlxcһֲϵͳϵԴ⻯ 
	ĺôڿչɿصļԴȫ룬ͨAPIв𣻵ȱڣÿһ̨һԴתһĲϵͳ

״̬󣬰ѿͻ״̬ͨcookie״̬
ʹmemcached cassandra ʵdistriubte session  

Cassandra does not support joins or subqueries, except for batch analysis through Hadoop

No join or subquery support, and limited support for aggregation. This is by design, to force you to denormalize into partitions that can be efficiently queried from a single replica, instead of having to gather data from across the entire cluster.

   Java for the big enterprise systems, back end trading platforms etc.
   C++ for the low latency / high performance stuff C/C++ for the analytics
   C# for front-end / desktop apps
   R for ֮
   
   infiniband based RDMA. In the order of 10usec rather than around 70usec for 10GigE for a transfer
   C++ more reliable. 
    How much faster is C++ than Java for your application
    
    csװbs webkit
    
ʵڴһϵʵеʱǷ㷨Ǹļʲ10%
෴㷨ȣռݿʺôӦóĿԸ
TCPƺͿɿԣܱȽϲUDPҪȷϣҪӵӣԿ
UDP/TCPͬʱܵʱudpռ


ΪߵܶѾ㹻ˡRedisֻʹõˣMemcachedʹöˣڱȽϣƽÿһRedisڴ洢СʱMemcachedܸߡ100kϵУMemcachedҪRedisȻRedisҲڴ洢ݵϽŻǱMemcached
ݳ־ûͬҪôƼѡRedis
redisǿĵطбȽϷḻݽṹڻܶ໨
memcacheǿǷֲʽȽϳ죬ԶcpuӦ Ƚϳ죬ȶ


ܹȽ
Ӽܹ˵Ȼ Jetty  Tomcat Ӽ򵥣 Tomcat ļܹǺ˽Ļȿһ Tomcatϵͳܹģʽƪ¡
Jetty ļܹǰķ֪ǻ Handler ʵ֣ȻҲ֧ JMXҪĹչ Handler ʵ֡˵ Jetty  Handler ļܹ Spring  Bean ļܹiBATIS  statement һ Tomcat Զ༶ģǵļܹƱȻһԪ񡱣Ԫ񡰹
ģǶ Handler ʵϾһģʽӿ HandlerCollection ԰߹һһӿ ScopeHandler ԰ķ˳һõģǹ۲ģʽģʽ Jetty ڣֻҪ̳ LifeCycle ӿڣĶͿԽ Jetty ͳһˡչ Jetty ǳ򵥣Ҳ⣬ܹϵļҲޱȵĺôJetty ԺױչͲü
֮£Tomcat Ҫӷ׺ܶ࣬Tomcat Ϻܸӣǰ˵ Tomcat ĺƣ Server  Service ٵ engine  container ΪһӦ÷޿ںǣķֲҲΪ˸õչչķʽǽӦ÷ڲṹ¶ⲿʹߣʹչ TomcatԱҪ˽ Tomcat ƽṹȻ֪ΰĹ淶չξ˶ Tomcat ѧϰɱʵ Tomcat ҲлƷʽ Pipeline  Vavle Ҳ Jetty  Handler ƵķʽҪԼʵһ Vavle дһ Handler ѶȲ¡ϿTomcat ĹҪ Jetty ǿΪ Tomcat Ѿ˺ܶ๤ˣ Jetty ֻߣôȥʵ֡
ȷСѧѧTomcat  1+1=21+2=32+2=4 ȻԸʽó 1+1+2=4ҪĹʽܼ㣬 Jetty ǸӼ˳㷨ȻͿԸԼˡһ JettyJetty 쳣ǿ
ܱȽ
Ƚ Tomcat  Jetty 岻Ǻֻܴ˵ĳʹó£ֵĸв졣ΪʹóͬӼܹ Tomcat ڴǳæϸƣҲ˵ӵ̵ĻTomcat ܸߡ
 Jetty պ෴Jetty ͬʱӶҿԳʱ䱣ЩӡһЩ web Ӧ÷ǳʺ Jetty Ա web  Jetty Ϊ Servlet 档
 Jetty ļܹǳ򵥣Ϊ԰ҪȥοԼٷڴ濪һҲǿԼٲʱҲߡ Jetty Ĭʹõ NIO ڴ I/O ϸռƣTomcat Ĭʹõ BIOڴ̬ԴʱTomcat ܲ Jetty


 OpenAPI ڴ󲿷ֵķṩ̲ȡ OAuth ʽ֤ 
 OpenAPIΪ ͺͷԺͼ࣬ҪRPCRESTַʽ,JSONӶ
 
 LVSǴĲϢиתģ̶ֱܴòϵͳʵϢתתޣNATģʽLoad BalancerܵӰܴͬʱڸѹԼ̨ڵĿơLVSкܶĿԴȻ֤ȺĽ׳ԡLVSӦòתĳ˽һоHA-ProxyֻڻӦü7Ϣתĸؾⷽ
 Oauth ǶӦȨSSOҪڲʹ(opensso from sun ,cas from Yale)
 
 ʹOAuth֤ȨĹʾ:

    ûʿͻ˵վԼڷṩԴ
    ͻṩһʱơ
    ṩ֤ͻ˵ݺһʱơ
    ͻ˻ʱƺ󣬽ûṩȨҳûȨнʱƺͿͻ˵Ļصӷ͸ṩ
    ûڷṩҳû룬ȻȨÿͻ˷Դ
    Ȩɹ󣬷ṩûؿͻ˵ҳ
    ͻ˸ʱƴӷṩȡ 
    ṩʱƺûȨͻ˷ơ
    ͻʹûȡķƷʴڷṩϵܱԴ
 ð׻˵ǣAṩ˻OAUTHЭķBҪûRAԴBҪA룬AҪѯûRǷͬBԴʱAҪRͨû¼ģûֻûRAעģBûһϵ,ûRͬˣôԺBͿԷԴˡRûB͸¶һصûϢ

SSOڶӦϵͳУûֻҪ¼һξͿԷ໥εӦϵͳԽҪĵ¼ӳ䵽Ӧͬһûĵ¼ĻơĿǰȽеҵҵϵĽ֮һ

 
 mysqlƿԿƽ̨5.6ְ֧ͬ(ֻҪһsalveȷյд뼴)
 ֻ첽ִ Ըݿ⣬Ʊ ͨƵ޸־ɵ
 
 NDB cluster ֧ͬ
 
 Maria DB mysql ĿԴ֧ mysql ʼ˽
 
 
1.㣺Ҫ豸׼ߵĽӿ͡˵Ľӿִ͡ʵĴʵȡҪǴ(10תΪǿд䣬ĿĵغתΪ10Ҳǳ˵ģתģת)һݽء
2.·㣺øʽԽд䣬Լÿƶʵķʡһͨṩ;ȷݵĿɿ䡣
3.㣺λڲͬλõеϵͳ֮ṩӺ·ѡInternetķչʹôվϢûӣǹӵĲ㡣
4.㣺һЩݵЭͶ˿ں(WWW˿80)磺TCP(Э飬ЧʵͣɿǿڴɿҪߣ)UDP(ûݱЭ飬TCPǡǡ෴ڴɿҪ󲻸ߣСݣQQݾַͨʽģ Ҫǽ²յݽзֶκʹ䣬Ŀĵַٽ顣һݽΡ
5.Ự㣺ͨ(˿ںţ˿ն˿)ݴͨ·Ҫϵͳ֮䷢Ự߽ܻỰ(豸֮ҪʶIPҲMAC)
6.ʾ㣺ȷһϵͳӦò͵ϢԱһϵͳӦòȡ磬PCһ̨ͨţһ̨ʹչһʮƽ(EBCDIC)һ̨ʹϢ׼루ASCIIʾַͬбҪʾͨʹһͨʽʵֶݸʽ֮ת
7.Ӧò㣺ûOSI㡣һΪûӦó(ʼļն˷)ṩ


 
ITSMIT ITIL V3 ù+¹ʹ(Incident Management)+(Problem Management)+(Change Management)+Release Management
̨+Capacity Management+Availability Management+IT Service Continuity Management+Financial management of IT Services+Service Level Management
ҿITILV3V2ITŵERP,V3EPM
ҵЧITţһǴսԳ ITIL V3.ҪսԵĲ֣ITսҪҵս
Infrastructure Technology Infrastructure LibraryITIL) Ӣ֯һ֪IT̺רҹͬоγɵһITҵķ׼

IT( IT Service financial Management) , ǸԤͺṩITĳɱͻȡӦõĹ̡ITͶԤ㡢ITɱͷǷ3, Ŀͨɱٳɱ֧, ٲҪ˷, ͻΪITΪ񼶱ITԹͱṩݡ

BMCIBMHPCAȣҲйڵ̩Ʒ׿Ƽȹ˾
   

֧֣¼⡢ù
񽻸񼶱ԡԡIT
Դ  OTRS Open Ticket Request System  iTOP

COBIT(Control Objectives for Information and related Technology) ĿǰͨõϢϵͳƵı׼


DRBDȫDistributed Replicated Block ֲʽĸƿ豸Device˾ȫԴһڿ豸ļƽٶȱļNFSsambaܶ࣬ǺܶСҵĹ洢ѡ

DRBDҪڵͬʱ׼һһģһķɾΪʲôֲʽƿ豸ҪͨʵļͬݣҪڼȺļ ͨĹԭ˽鸴ƺļƵĲͬͼ

ȣҪ֪DRBDǹϵͳں˿ռ䣬ûռ䣬ֱӸƵǶݣٶȿĸԭ
ΣDRBDҪڵһһΡ
DRBDݽBuffer CacheʱȾDRBDһ㣬һݾTCP/IPЭװ͵һڵϣһڵͨTCP/IPЭܸƹݣͬνڵDRBD豸ϡ

4 ļϵͳ͵֧֡DRBD  ֳָܹ֧ļϵͳ֮⣬ ֧ GFSOCFS2 ȷֲʽļϵͳңʹ÷ֲʽļϵͳʱ򣬻 ʵָͬʱṩ IO 
5 ṩ LVM  ֧֡DRBD  ȿʹ LVM  ṩ߼豸ҲԽԼ ṩ豸Ϊ LVM  豸⼫ķάԱԴ洢豸Ĺ
6  IO ܹԵı֤ IO ˳ҲǶݿ˵ǳҪһ һЩһҪǳ̵ݿ˵
  2 Split Brain  ĽΪĳЩԭ̨֮ DRBD  ж ֮˫ Primary ɫ֮Ĵ̫ȶȻ DRBD  ļпԶ Split BrainǴ֮ǰĲÿ εĽǳ⣬Щ£ܳĳڵȫʧЧĿܡ
  
  Խʾdrbd8.3.2 64bitܶ࣬ͲDRBDʱʧС绷оҪԸߵĳϣԿʹãδlinux kernel2.6.32drbd֧
  
  GlusterFS runOS filesystem֮ You can use ZFS on Linux with Gluster, although XFS continues to be recommend. 

    Far more scalable
    replication at a file rather than a block level
    development funded by Red Hat
    If you want file level access, no need for a clustered file system (GFS2 sucks),
    Native support from KVM and Openstack
    REST access via translators

Cons:

    POSIX access via FUSE potentially lower performance (in theory)
    Edit: Nah, thought of one, buts it gone

DRDB

Pros:

    Block level replication and proud!
    We're included in the Linux Kernel as of 2.6.33.
    Provides your %99.999+ uptime goals for High Availability
    Disaster Recovery: We replicate perfectly over the WAN.
    Performance: Your bottleneck is the hardware you're running.
    Time tested: We've been the best replication solution for over 10 years running.
    Transaction safe: There's a reason that Oracle recommends using DRBD with MySQL: it's the safest way to replicate data from point a to b.
    Reputation: Leading industry names rely upon DRBD everyday: Google, IBM, Cisco, Siemens, maybe even reddit.com
    Industry Accepted: DRBD is an add-on to your existing Red Hat subscription (Red Hat fully supports and recommends DRBD as a solution)
    Replicates at the block level, not the file system
    Ability to detect disk hardware errors, and not replicate them
    Flexibility in replication protocols

Cons:

    DRBD 9 isn't released yet - multi-master replication, multinode replication



Keepalived Heartbeat
Corosyncͬһ͵ġKeepalived
ʹõvrrp Э鷽ʽ·Э
(VirtualRouterRedundancyProtocol
VRRP)Heartbeat Corosync ǻ
ĸ߿÷ʽ򵥵˵ǣ
Keepalived Ŀ ģ·ĸ߿ã
Heartbeat  Corosync ĿʵService
ĸ߿á
Keepalived ʵĸ߿ãһ
ǰ˸߿ãҲҪ洢һ㳣
ڵĸ߿áHeartbeat(Corosync)
һڷĸ߿ãҪ洢һ
ڶڵĸ߿
һ· У˭MASTERⶼͬMAC IP(֮ΪVIP)

HAProxyΪMySQLʼķwebĸؾ⣬ǳΪMySQL()ؾ

puppetһLinuxUnixwindowsƽ̨ļùϵͳʹеpuppetԣɹļûcronϵͳȡpuppetЩϵͳʵ֮ΪԴpuppetĿǼ򻯶ЩԴĹԼƴԴϵ
puppetC/S״ĽṹеĿͻ˺һ򼸸ÿͻڵģĬϰСʱ󣬻µϢ֤͸ϢͬÿpuppetͻÿСʱ()һη, µļ,ϸļ÷. Ժ,puppetͻ˿ԷһϢ. ,Ҳ˷һϢ.

ChefRubyдɵ̬

KVM
openstackƽ̨жkvmɾͣ/ָVNC
Reverse ProxyʽָԴinternetϵȻתڲϵķӷϵõĽظinternetӵĿͻˣʱͱΪһ

ֱoffload infini band tcp/off load,ֱƹkernelĴ


                ֶ                           Ч

SYNflood             ǽϺãԷǽCPUҪ      Ҫɱ
TCP flood            ǽϺãԷǽCPUҪߣ       Ҫɱ
http flood              Nginxʴƣ֤ƿ٣  ԽϸԼײɱûʧ
ڵ  
iops                 ǿcache֤             Чռò


˶ԼںˣXenںܶϣӵͳɱר÷Virtual Private ServerVPSӦ̣Linode͹˾AmazonEC2Щ˾ӴⷽͶ룬תʹKVMԽXenҲһ¾ȡеĽοKVMڼϵƲԣЩطδԽXenΪXenʷKVMƾãҲKVM죬ᷢXenеĳЩKVMδʵ֣ǿKVMĿTodo ListܳKVMҲLinuxںˡRHEL 5.4ʼRedHat֧KVMˣRHEL 6.0ʼRedHatȫXenˡ
      KVMһȫ⻯Ľx86ܹļʵ⻯ܡKVMҪCPU⻯ֻ֧֣ܵھ⻯ֵ֧CPUУVTܵIntel CPU;AMD-VܵAMD CPU
        XenLinuxµһ⻯ڱCitrixչ󣬱˺ͺñҵһˣȡãRedhatrhel6.0ʼѾںаXEN߳ȥˣȫͶ뿪ѵKVMȻгûXen,kvmռгؾredhatΪǿ֧Դ
        
   ȽϣKVMͼ򻯵ĶˡҪ±ںˣҲҪԵǰkernelκ޸ģֻǼԶ̬ص.koģ顣ṹӾ򡢴СԣĿԸСĳЩ棬ܱXenʤһ
   

KVM  ͼԵõĽ:ʹwrite through,nonewrite back
cpuܺcpuܲ
CPU,ڴ涼,Ӳ,ͨǰһϵеĲ,Ƽʹ:?ʹExt4Ϊ̸ʽ?qcow2+preallocation,
ʹwriteback
ʹvirtio



   
OpenStack֧е⻯򣬲ǿԴ(XenKVM)ǳ̵(Hyper-VVMware)ǰOp
enStackǻKVMģKVMΪĬϵ߶ʹͬĿԴ뿪
- OpenStack Compute(Nova)һ׿ʹȺʵ;

- OpenStack(Glance)һҼϵͳʵ;

- OpenStack洢(Swift)һڴģչϵͳͨ༰ݴƣԶΪλĴ洢ϵͳAmazon S3;

- OpenStack KeystoneûݷԴԼ

- OpenStack HorizonDjangoǱӿڣǸͼλǰˡ
 
zabbix(c+php) Դϵͳ Nagios  Tivoli openview grid controller  

һֱ Nagios Zabbix ǿ󣬺ȫ棬˵Nagios ҪرĲƣԼϤʵּκԼҪʵֵļء
Nagios ͼԽֻϣʵּؼNagios ǸѡͼԽ cactiֱ rrdtool ʵ֡

NagiosļԶƣÿִһZabbixļԼС
 

 ʹã
C Nagios ڷ״̬⼰Զά
ճʹòڱ
C Cacti ݼ¼ʷչ֣Դȼ
ݷĻճʹòݼ¼
C RRDTOOL Shell ʵһ׻
C ϵͳ־ͨsyslog ۴ţ飬Ҫ
Ϣ; Email,IM,SMS etc. 

Ŀǰ5.1İ汾кܶbug,ѡʹúܾõmysql5.0.41.
Ϊҵ󲿷дٶ࣬myisamǲѡ
:mysqldumpΪMySQLǰݻָĹ,֧ȫģʽµı,ұݳΪıļ,ѹ洢ռ,ıļҪloadָܻ,ݻָٶݵĶ,ȻֵƼ

?MySQLݸOracleбʵ
?mysql,ӻϾܱ֤ݵԺͰȫ
?MySQL Binlog VS Oracle ARCHIVELOG
?ȫ+binlogǿָָʱ

޶ϵͳڴͨgrub.confļmem=1GĲ

ֲʽļϵͳ

?Hadoop
?FastDFS
?MooseFS
?PNFSParallel NFS 
?PVFSPVFS2
?Lustre
?

openfiler  Openfiler һƻĲϵͳṩ˻ļ總Ӵ洢 NAS ͻڿĴ洢 SAN 洢Openfiler ṩǿ洢ԣʹԶ̬ΪʵƼ㻷УΪһǳƶ˴洢֮һ

ʵʩ򵥡MFSİװֹ˵Ҫ򵥺׵öࡣlustre 700ҳpdfĵͷ
?ͣݡMFSúʱӷͼԲӰеķ
?ָסMFS߱߿⣬ֶָҲǷǳݵ


2012ƼѿԴ
OpenStack ITͷͶʵĿԴƽ̨Ծȷǳߡ
CloudStack CitrixƳĿԴƽ̨ӵзǳõWeb UIȽϸߡ
Eucalyptus һҳ˾˾AWSȺAPIAWSٷ֧֡
Ganeti GoogleСߣ֧XenKVM
Open vSwitch һֲʽ⽻ϵͳԽĳЩ
Cloud Foundry ΨһһѡPaaSƽ̨VMware
JBoss AS7Red HatJavaӦ÷
JcloudsJcloudsһAPI㣬AWSOpenStackWindows Azure,Eucalyptusƽ̨ϵAPIῪߵĹ
PuppetһȺάʦءԶ÷ȡ
ChefRubyдɵ̬һִRubyרԣDSLϵͳá
JujuUbuntuϵƹƽ̨
GlusterFS һֲַʽļϵͳĿǰѱRed Hatչ
Ceph һӦǿķֲʽļϵͳ,Ŀǰ̫ʺproduction  Ceph is hot, hot, hot  Ceph  use of btrfs  ceph making it into the Linux kernel
FreeNASFreeBSDĿԴ洢ƽ̨
OpenfilerOpenfilerFreeNASָ֧SANNAS
NAS4FreeFreeNAS 7չĿ/У 

Hadoop
looks very stable, mature and scalable solution
Not fully posix compliance and not the fastest 
GlusterFS
Very fast,posix compliant, and easy to manage
Maybe not as scalable as the others, still have few
reliability problems 

CEPH:
Looks very scalable, complete and technological advanced
Still not very mature and stable, performance issues 



CephĿȫķֲʽžκεϡCephҪPBݴ洢ϵͳչEB
洢ͨCC++JavaPythonPHP󶨻ΪradosgwRESTӿڽзʣýӿS3Swiftݡ
洢ʹCephRADOS Block DeviceRBDݱɢ洢ȺСRBDѾKVM˼ɡ
CephṩļϵͳPOSIXļϵͳbtrfsext3ext4xfsݡ

swift,Ϊ洢ȶԻûɶ⡣sinaǱʹãۺܸߡ
ԱѡsheepdogҸ˻ǱȽϿceph



Swiftļϵͳʵʱݴ洢ϵͳΪ洢 OpenStack Swift(Rackspace ) Ϊȶ͸߿õĿԴ洢ܶҵΪҵ
redhatGFSgloble file system,Ѿ𽥱 GlusterFSȡ

SwiftṩķAmazon S3ͬӦó͵ӦΪƷĴ洢棬DropboxʹAmazon S3Ϊ֧ŵġOpenStackл뾵GlanceϣΪ洢ļ⣬SwiftչҲǳʺڴ洢־ļݱݲֿ⡣
ȫԳƵϵͳܹ ԳơζSwiftиڵȫԵȣܼؽϵͳάɱ
޵Ŀչ  չԷ棬һݴ洢޿չSwiftܣQPSȣΪSwiftȫԳƵļֻܹ򵥵ϵͳԶǨƵȹʹ洢ڵ´ﵽƽ״̬
޵ 

OpenStack SummitϣCephΪԴ洢ʵֵǣݶԸ̵Ĺ۲죬󲿷ֶѡȡCephΪԼĴ洢󱸣CiscoMirantiseNovancePistonIntelDellȵ
CephиblockӿںOpenstackļɣGlusterfsиõļϵͳӿ
OpenStackУKVMֿ֧洢Ǩ

SwiftСļͼ񣩴洢ϣܺܺ

CephC++дSwiftPythonдӦCephռšCephͬSwiftרעڶ洢ΪOpenStack֮һʵ֤OpenStackϺܺãĿǰʹCephΪOpenStackṩ洢ԾʹSwiftṩ洢


OpenStackеӦΪWebQAԻݿ⡢ƽ̨ɺԶϵͳ洢ϵͳ桢ھʹݴϵͳܼ㡣
OpenStack𹤾ߵУʹPuppet֮࣬DevStackChefPackStackԼCrowbarSaltStack

ղͻ֣60%OpenStackΪҵڲ˽ƣ17%йܵ˽ơƲռ15%Ʋռ6%ʣµ2%άOpenStackġ

Host OS55%Ubuntu24%CentOS10%RHEL⻯62%KVM12%XEN8%ESX⻹Xenserver4%HyperV3%LXC4%QEMU5%2%ԼOpenVZ1%

ʹ42%Open vSwitch28%Linux Bridge10%Cisco6%Nicira洢ʹ31%LVM17%Ceph16%NFC
ĿǰCephٷƼXFSΪײļϵͳ

